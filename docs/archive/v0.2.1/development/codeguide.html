
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>Coding Guidelines &mdash; Astropy v0.2.1</title>
<!-- RTD <head> -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/underscore.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/doctools.js"></script>

<script type="text/javascript">
  // This is included here for Javascript that doesn't have access to the templates.
  var doc_version = "v0.2.1";
  var doc_slug = "astropy";
</script>

<script type="text/javascript" src="//media.readthedocs.org/javascript/rtd.js"></script>
<!-- end RTD <head> -->

    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v0.2.1" href="../index.html" />
    <link rel="next" title="Emacs setup for following coding guidelines" href="codeguide_emacs.html" />
    <link rel="prev" title="Workflow for Maintainers" href="workflow/maintainer_workflow.html" /> 
  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"></a>
  <ul>
    <li><a class="homelink" title="AstroPy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Python Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="codeguide_emacs.html" title="Emacs setup for following coding guidelines">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="workflow/maintainer_workflow.html" title="Workflow for Maintainers">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v0.2.1</a>
	 &raquo;
      </li>
      
      <li>Coding Guidelines</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="coding-guidelines">
<h1>Coding Guidelines<a class="headerlink" href="#coding-guidelines" title="Permalink to this headline">¶</a></h1>
<p>This section describes requirements and guidelines that should be followed
both for the core package and for affiliated packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Affiliated packages will only be considered for integration as a
module in the core package once these guidelines have been
followed.</p>
</div>
<div class="section" id="interface-and-dependencies">
<h2>Interface and Dependencies<a class="headerlink" href="#interface-and-dependencies" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">All code must be compatible with Python 2.6, 2.7, as well as 3.1 and
later. All files should include the preamble:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>
</pre></div>
</div>
<p>and therefore use the <tt class="docutils literal"><span class="pre">print()</span></tt> function from Python 3. In addition, the
new Python 3 formatting style should be used (i.e.
<tt class="docutils literal"><span class="pre">&quot;{0:s}&quot;.format(&quot;spam&quot;)</span></tt> instead of <tt class="docutils literal"><span class="pre">&quot;%s&quot;</span> <span class="pre">%</span> <span class="pre">&quot;spam&quot;</span></tt>), although when
using positional arguments, the position should always be specified (i.e.
<tt class="docutils literal"><span class="pre">&quot;{:s}&quot;</span></tt> is not compatible with Python 2.6). Astropy automatically runs
the <a class="reference external" href="http://docs.python.org/library/2to3.html">2to3 tool</a> on the source
code, so in cases where syntax is different between Python 2 and 3, the
Python 2 syntax should be used.</p>
</li>
<li><p class="first">The core package and affiliated packages should be importable with no
dependencies other than components already in the Astropy core, the
<a class="reference external" href="http://docs.python.org/release/2.6/library/index.html">Python Standard Library</a>, and <a class="reference external" href="http://numpy.scipy.org/">NumPy</a> 1.4
or later.</p>
</li>
<li><p class="first">The package should be importable from the source tree at build time. This
means that, for example, if the package relies on C extensions that have
yet to be built, the Python code is still importable, even if none of its
functionality will work. One way to ensure this is to import the functions
in the C extensions only within the functions/methods that require them
(see next bullet point).</p>
</li>
<li><p class="first">Additional dependencies - such as <a class="reference external" href="http://www.scipy.org/">SciPy</a>, <a class="reference external" href="http://matplotlib.sourceforge.net/">Matplotlib</a>, or other
third-party packages - are allowed for sub-modules or in function calls,
but they must be noted in the package documentation and should only affect
the relevant component.</p>
</li>
<li><p class="first">General utilities necessary for but not specific to the package or
sub-package should be placed in the <tt class="xref py py-mod docutils literal"><span class="pre">packagename.utils</span></tt>. These
utilities will be moved to the <tt class="xref py py-mod docutils literal"><span class="pre">astropy.utils</span></tt> module when the
package is integrated into the core package. If a utility is already
present in <tt class="xref py py-mod docutils literal"><span class="pre">astropy.utils</span></tt>, the package should always use that
utility instead of re-implementing it in <tt class="xref py py-mod docutils literal"><span class="pre">packagename.utils</span></tt>.</p>
</li>
</ul>
</div>
<div class="section" id="documentation-and-testing">
<h2>Documentation and Testing<a class="headerlink" href="#documentation-and-testing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Docstrings must be present for all public classes/methods/functions, and
must follow the form outlined in the <a class="reference internal" href="docguide.html"><em>Documentation Guidelines</em></a> document.</li>
<li>Unit tests should be provided for as many public methods and functions as
possible, and should adhere to the standards set in the <a class="reference internal" href="testguide.html"><em>Testing Guidelines</em></a>
document.</li>
</ul>
</div>
<div class="section" id="data-and-configuration">
<h2>Data and Configuration<a class="headerlink" href="#data-and-configuration" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Packages can include data in a directory named <tt class="xref py py-obj docutils literal"><span class="pre">data</span></tt> inside a subpackage
source directory as long as it is less than about 100 kb. These data should
always be accessed via the <a class="reference internal" href="../_generated/astropy.utils.data.get_pkg_data_fileobj.html#astropy.utils.data.get_pkg_data_fileobj" title="astropy.utils.data.get_pkg_data_fileobj"><tt class="xref py py-func docutils literal"><span class="pre">astropy.utils.data.get_pkg_data_fileobj()</span></tt></a> or
<a class="reference internal" href="../_generated/astropy.utils.data.get_pkg_data_filename.html#astropy.utils.data.get_pkg_data_filename" title="astropy.utils.data.get_pkg_data_filename"><tt class="xref py py-func docutils literal"><span class="pre">astropy.utils.data.get_pkg_data_filename()</span></tt></a> functions. If the data
exceeds this size, it should be hosted outside the source code repository,
either at a third-party location on the internet or the astropy data server.
In either case, it should always be downloaded using the
<a class="reference internal" href="../_generated/astropy.utils.data.get_pkg_data_fileobj.html#astropy.utils.data.get_pkg_data_fileobj" title="astropy.utils.data.get_pkg_data_fileobj"><tt class="xref py py-func docutils literal"><span class="pre">astropy.utils.data.get_pkg_data_fileobj()</span></tt></a> or
<a class="reference internal" href="../_generated/astropy.utils.data.get_pkg_data_filename.html#astropy.utils.data.get_pkg_data_filename" title="astropy.utils.data.get_pkg_data_filename"><tt class="xref py py-func docutils literal"><span class="pre">astropy.utils.data.get_pkg_data_filename()</span></tt></a> functions. If a specific
version of a data file is needed, the hash mechanism described in
<a class="reference internal" href="../utils/index.html#module-astropy.utils.data" title="astropy.utils.data"><tt class="xref py py-mod docutils literal"><span class="pre">astropy.utils.data</span></tt></a> should be used.</li>
<li>All persistent configuration should use the
<tt class="xref py py-obj docutils literal"><span class="pre">astropy.config.ConfigurationItem</span></tt> mechanism.  Such configuration items
should be placed at the top of the module or package that makes use of them,
and supply a description sufficient for users to understand what the setting
changes.</li>
</ul>
</div>
<div class="section" id="standard-output-warnings-and-errors">
<h2>Standard output, warnings, and errors<a class="headerlink" href="#standard-output-warnings-and-errors" title="Permalink to this headline">¶</a></h2>
<p>The built-in <tt class="docutils literal"><span class="pre">print(...)</span></tt> function should only be used for output that
is explicitly requested by the user, for example <tt class="docutils literal"><span class="pre">print_header(...)</span></tt>
or <tt class="docutils literal"><span class="pre">list_catalogs(...)</span></tt>. Any other standard output, warnings, and
errors should follow these rules:</p>
<ul class="simple">
<li>For errors/exceptions, one should always use <tt class="docutils literal"><span class="pre">raise</span></tt> with one of the
built-in exception classes, or a custom exception class. The
nondescript <tt class="docutils literal"><span class="pre">Exception</span></tt> class should be avoided as much as possible,
in favor of more specific exceptions (<tt class="docutils literal"><span class="pre">IOError</span></tt>, <tt class="docutils literal"><span class="pre">ValueError</span></tt>,
etc.).</li>
<li>For warnings, one should always use <tt class="docutils literal"><span class="pre">warnings.warn(message)</span></tt>. These
get redirected to <tt class="docutils literal"><span class="pre">log.warn</span></tt> by default, but one can still use the
standard warning-catching mechanism and custom warning classes.</li>
<li>For informational and debugging messages, one should always use
<tt class="docutils literal"><span class="pre">log.info(message)</span></tt> and <tt class="docutils literal"><span class="pre">log.debug(message)</span></tt>.</li>
</ul>
<p>The logging system uses the built-in Python <a class="reference external" href="http://docs.python.org/library/logging.html">logging</a> module. The logger can
be imported using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">log</span>
</pre></div>
</div>
</div>
<div class="section" id="coding-style-conventions">
<h2>Coding Style/Conventions<a class="headerlink" href="#coding-style-conventions" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">The code will follow the standard <a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">PEP8 Style Guide for Python Code</a>. In particular, this includes
using only 4 spaces for indentation, and never tabs.</p>
</li>
<li><p class="first">One exception is to be made from the PEP8 style: new style relative imports
of the form <tt class="docutils literal"><span class="pre">from</span> <span class="pre">.</span> <span class="pre">import</span> <span class="pre">modname</span></tt> are allowed and required for Astropy,
as opposed to absolute (as PEP8 suggets) or the simpler <tt class="docutils literal"><span class="pre">import</span> <span class="pre">modname</span></tt>
syntax. This is primarily due to improved relative import support since PEP8
was developed, and to simplify the process of moving modules.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are multiple options for testing PEP8 compliance of code,
see <a class="reference internal" href="testguide.html"><em>Testing Guidelines</em></a> for more information.
See <a class="reference internal" href="codeguide_emacs.html"><em>Emacs setup for following coding guidelines</em></a> for some configuration options for Emacs
that helps in ensuring conformance to PEP8.</p>
</div>
</li>
<li><p class="first">Astropy source code should contain a comment at the beginning of the file (or
immediately after the <tt class="docutils literal"><span class="pre">#!/usr/bin</span> <span class="pre">env</span> <span class="pre">python</span></tt> command, if relevant)
pointing to the license for the Astropy source code.  This line should say:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
</pre></div>
</div>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></tt>, <tt class="docutils literal"><span class="pre">import</span> <span class="pre">matplotlib</span> <span class="pre">as</span> <span class="pre">mpl</span></tt>, and <tt class="docutils literal"><span class="pre">import</span>
<span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></tt> naming conventions should be used wherever
relevant. <tt class="docutils literal"><span class="pre">from</span> <span class="pre">packagename</span> <span class="pre">import</span> <span class="pre">*</span></tt> should never be used, except as a
tool to flatten the namespace of a module. An example of the allowed usage
is given in <a class="reference internal" href="#import-star-example"><em>Acceptable use of from module import *</em></a>.</p>
</li>
<li><p class="first">Classes should either use direct variable access, or python’s property
mechanism for setting object instance variables. <tt class="docutils literal"><span class="pre">get_value</span></tt>/<tt class="docutils literal"><span class="pre">set_value</span></tt>
style methods should be used only when getting and setting the values
requires a computationally-expensive operation. <a class="reference internal" href="#prop-get-set-example"><em>Properties vs. get_/set_</em></a>
below illustrates this guideline.</p>
</li>
<li><p class="first">All new classes should be new-style classes inheriting from <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt>
(in Python 3 this is a non-issue as all classes are new-style by default).
The one exception to this rule is older classes in third-party libraries such
the Python standard library or numpy.</p>
</li>
<li><p class="first">Classes should use the builtin <a class="reference external" href="http://docs.python.org/library/functions.html#super" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> function when making calls to
methods in their super-class(es) unless there are specific reasons not to.
<a class="reference external" href="http://docs.python.org/library/functions.html#super" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> should be used consistently in all subclasses since it does not
work otherwise.  <a class="reference internal" href="#super-vs-direct-example"><em>super() vs. Direct Calling</em></a> illustrates why this is
important.</p>
</li>
<li><p class="first">Multiple inheritance should be avoided in general without good reason.
Mulitple inheritance is complicated to implement well, which is why many
object-oriented languages, like Java, do not allow it at all.  Python does
enable multiple inheritance through use of the
<a class="reference external" href="http://www.python.org/download/releases/2.3/mro/">C3 Linearization</a>
algorithm, which provides a consistent method resolution ordering.
Non-trivial multiple-inheritance schemes should not be attempted without
good justification, or without understanding how C3 is used to determine
method resolution order.  However, trivial multiple inheritance using
orthogonal base classes, known as the &#8216;mixin&#8217; pattern, may be used.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">__init__.py</span></tt> files for modules should not contain any significant
implementation code. <tt class="docutils literal"><span class="pre">__init__.py</span></tt> can contain docstrings and code for
organizing the module layout, however (e.g. <tt class="docutils literal"><span class="pre">from</span> <span class="pre">submodule</span> <span class="pre">import</span> <span class="pre">*</span></tt>
in accord with the guideline above). If a module is small enough that
it fits in one file, it should simple be a single file, rather than a
directory with an <tt class="docutils literal"><span class="pre">__init__.py</span></tt> file.</p>
</li>
<li><p class="first">When <tt class="docutils literal"><span class="pre">try...except</span></tt> blocks are used to catch exceptions, the <tt class="docutils literal"><span class="pre">as</span></tt>
syntax should always be used, because this is available in all supported
versions of python and is less ambiguous syntax (see
<a class="reference internal" href="#try-except-as-example"><em>try...except block &#8220;as&#8221; syntax</em></a>).</p>
</li>
<li><p class="first">Command-line scripts should follow the form outlined in the <a class="reference internal" href="scripts.html"><em>Writing Command-Line Scripts</em></a>
document.</p>
</li>
</ul>
</div>
<div class="section" id="including-c-code">
<h2>Including C Code<a class="headerlink" href="#including-c-code" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>C extensions are only allowed when they provide a significant performance
enhancement over pure python, or a robust C library already exists to
provided the needed functionality. When C extensions are used, the Python
interface must meet the aforementioned python interface guidelines.</li>
<li>The use of <a class="reference external" href="http://cython.org/">Cython</a> is strongly recommended for C extensions, as per the
example in the template package. <a class="reference external" href="http://cython.org/">Cython</a> extensions should store <tt class="docutils literal"><span class="pre">.pyx</span></tt>
files in the source code repository, but they should be compiled to <tt class="docutils literal"><span class="pre">.c</span></tt>
files that are updated in the repository when important changes are made to
the <tt class="docutils literal"><span class="pre">.pyx</span></tt> file.</li>
<li>If a C extension has a dependency on an external C library, the source code
for the library should be bundled with the Astropy core, provided the
license for the C library is compatible with the Astropy license.
Additionally, the package must be compatible with using a system-installed
library in place of the library included in Astropy.</li>
<li>In cases where C extensions are needed but <a class="reference external" href="http://cython.org/">Cython</a> cannot be used, the <a class="reference external" href="http://www.python.org/dev/peps/pep-0007/">PEP 7
Style Guide for C Code</a> is
recommended.</li>
<li>C extensions (<a class="reference external" href="http://cython.org/">Cython</a> or otherwise) should provide the necessary information
for building the extension via the mechanisms described in
<a class="reference internal" href="building_packaging.html#building-c-or-cython-extensions"><em>C or Cython Extensions</em></a>.</li>
</ul>
</div>
<div class="section" id="requirements-specific-to-affiliated-packages">
<h2>Requirements Specific to Affiliated Packages<a class="headerlink" href="#requirements-specific-to-affiliated-packages" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Affiliated packages implementing many classes/functions not relevant to
the affiliated package itself (for example leftover code from a previous
package) will not be accepted - the package should only include the
required functionality and relevant extensions.</li>
<li>Affiliated packages are required to follow the layout and documentation form
of the template package included in the core package source distribution.</li>
<li>Affiliated packages must be registered on the <a class="reference external" href="http://pypi.python.org/pypi">Python Package Index</a>, with proper metadata for downloading and
installing the source package.</li>
<li>The <tt class="xref py py-mod docutils literal"><span class="pre">astropy</span></tt> root package name should not be used by affiliated
packages - it is reserved for use by the core package. Recommended naming
conventions for an affiliated package are either simply <tt class="xref py py-mod docutils literal"><span class="pre">packagename</span></tt>
or <tt class="xref py py-mod docutils literal"><span class="pre">awastropy.packagename</span></tt> (&#8220;affiliated with Astropy&#8221;).</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This section shows a few examples (not all of which are correct!) to
illustrate points from the guidelines. These will be moved into the template
project once it has been written.</p>
<div class="section" id="properties-vs-get-set">
<span id="prop-get-set-example"></span><h3>Properties vs. get_/set_<a class="headerlink" href="#properties-vs-get-set" title="Permalink to this headline">¶</a></h3>
<p>This example shows a sample class illustrating the guideline regarding the use
of properties as opposed to getter/setter methods.</p>
<p>Let&#8217;s assuming you&#8217;ve defined a <tt class="xref py py-class docutils literal"><span class="pre">Star</span></tt> class and create an instance
like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="mf">5.48</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="mf">4.83</span><span class="p">)</span>
</pre></div>
</div>
<p>You should always use attribute syntax like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">color</span>
<span class="go">0.4</span>
</pre></div>
</div>
<p>Rather than like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>  <span class="c">#Bad form!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>  <span class="c">#Bad form!</span>
<span class="go">0.4</span>
</pre></div>
</div>
<p>Using python properties, attribute syntax can still do anything possible with
a get/set method. For lengthy or complex calculations, however, use a method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">compute_color</span><span class="p">(</span><span class="mi">5800</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mf">5e9</span><span class="p">)</span>
<span class="go">0.4</span>
</pre></div>
</div>
</div>
<div class="section" id="super-vs-direct-calling">
<span id="super-vs-direct-example"></span><h3>super() vs. Direct Calling<a class="headerlink" href="#super-vs-direct-calling" title="Permalink to this headline">¶</a></h3>
<p>This example shows why the use of <a class="reference external" href="http://docs.python.org/library/functions.html#super" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> leads to a more consistent
method resolution order than manually calling methods of the super classes in a
multiple inheritance case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This is dangerous and bug-prone!</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing A&#39;</span>


<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing B&#39;</span>
        <span class="n">A</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing C&#39;</span>
        <span class="n">A</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing D&#39;</span>
        <span class="n">C</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">B</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>
</div>
<p>if you then do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
</pre></div>
</div>
<p>you will see:</p>
<div class="highlight-python"><pre>Doing B
Doing A</pre>
</div>
<p>which is what you expect, and similarly for C. However, if you do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
</pre></div>
</div>
<p>you might expect to see the methods called in the order D, B, C, A but instead
you see:</p>
<div class="highlight-python"><pre>Doing D
Doing C
Doing A
Doing B
Doing A</pre>
</div>
<p>because both <tt class="docutils literal"><span class="pre">B.method()</span></tt> and <tt class="docutils literal"><span class="pre">C.method()</span></tt> call <tt class="docutils literal"><span class="pre">A.method()</span></tt> unaware of
the fact that they&#8217;re being called as part of a chain in a hierarchy.  When
<tt class="docutils literal"><span class="pre">C.method()</span></tt> is called it is unaware that it&#8217;s being called from a subclass
that inherts from both <tt class="docutils literal"><span class="pre">B</span></tt> and <tt class="docutils literal"><span class="pre">C</span></tt>, and that <tt class="docutils literal"><span class="pre">B.method()</span></tt> should be
called next.  By calling <a class="reference external" href="http://docs.python.org/library/functions.html#super" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> the entire method resolution order for
<tt class="docutils literal"><span class="pre">D</span></tt> is precomputed, enabling each superclass to cooperatively determine which
class should be handed control in the next <a class="reference external" href="http://docs.python.org/library/functions.html#super" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This is safer</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing A&#39;</span>

<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing B&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing C&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&#39;Doing D&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
<span class="go">Doing D</span>
<span class="go">Doing C</span>
<span class="go">Doing B</span>
<span class="go">Doing A</span>
</pre></div>
</div>
<p>As you can see, each superclass&#8217;s method is entered only once.  For this to
work it is very important that each method in a class that calls its
superclass&#8217;s version of that method use <a class="reference external" href="http://docs.python.org/library/functions.html#super" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> instead of calling the
method directly.  In the most common case of single-inheritance, using
<tt class="docutils literal"><span class="pre">super()</span></tt> is functionally equivalent to calling the superclass&#8217;s method
directly.  But as soon as a class is used in a multiple-inheritance
hierarchy it must use <tt class="docutils literal"><span class="pre">super()</span></tt> in order to cooperate with other classes in
the hierarchy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more info on the pros and cons of using super, see
<a class="reference external" href="http://rhettinger.wordpress.com/2011/05/26/super-considered-super/">http://rhettinger.wordpress.com/2011/05/26/super-considered-super/</a>
or <a class="reference external" href="http://keithdevens.com/weblog/archive/2011/Mar/16/Python.super">http://keithdevens.com/weblog/archive/2011/Mar/16/Python.super</a>)</p>
</div>
</div>
<div class="section" id="acceptable-use-of-from-module-import">
<span id="import-star-example"></span><h3>Acceptable use of <tt class="docutils literal"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span> <span class="pre">*</span></tt><a class="headerlink" href="#acceptable-use-of-from-module-import" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span> <span class="pre">*</span></tt> is discouraged in a module that contains
implementation code, as it impedes clarity and often imports unused variables.
It can, however, be used for a package that is laid out in the following
manner:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">packagename</span>
<span class="n">packagename</span><span class="o">/</span><span class="n">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="n">packagename</span><span class="o">/</span><span class="n">submodule1</span><span class="o">.</span><span class="n">py</span>
<span class="n">packagename</span><span class="o">/</span><span class="n">submodule2</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>In this case, <tt class="docutils literal"><span class="pre">packagename/__init__.py</span></tt> may be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A docstring describing the package goes here</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">submodule1</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">submodule2</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>This allows functions or classes in the submodules to be used directly as
<tt class="docutils literal"><span class="pre">packagename.foo</span></tt> rather than <tt class="docutils literal"><span class="pre">packagename.submodule1.foo</span></tt>. If this is
used, it is strongly recommended that the submodules make use of the __all__
variable to specify which modules should be imported. Thus, submodule2.py
might read:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span><span class="n">linspace</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">,</span><span class="s">&#39;AClass&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">bar</span><span class="p">):</span>
    <span class="c">#the function would be defined here</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">AClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c">#the class is defined here</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>This ensures that <tt class="docutils literal"><span class="pre">from</span> <span class="pre">submodule</span> <span class="pre">import</span> <span class="pre">*</span></tt> only imports <tt class="xref py py-func docutils literal"><span class="pre">foo()</span></tt> and
<tt class="xref py py-class docutils literal"><span class="pre">AClass</span></tt>, but not <tt class="xref py py-class docutils literal"><span class="pre">numpy.array</span></tt> or <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html#numpy.linspace" title="(in NumPy v1.7)"><tt class="xref py py-func docutils literal"><span class="pre">numpy.linspace()</span></tt></a>.</p>
</div>
<div class="section" id="try-except-block-as-syntax">
<span id="try-except-as-example"></span><h3>try...except block &#8220;as&#8221; syntax<a class="headerlink" href="#try-except-block-as-syntax" title="Permalink to this headline">¶</a></h3>
<p>Catching of exceptions should always use this syntax:</p>
<div class="highlight-python"><pre>try:
    ... some code that might produce a variety of exceptions ...
except ImportError as e:
    if 'somemodule' in e.args[0]"
        #for whatever reason, failed import of somemodule is ok
        pass
    else:
        raise
except ValueError, TypeError as e:
    msg = 'Hit an input problem, which is ok,'
    msg2 = 'but we're printing it here just so you know:'
    print msg, msg2, e</pre>
</div>
<p>This avoids the old style syntax of <tt class="docutils literal"><span class="pre">except</span> <span class="pre">ImportError,</span> <span class="pre">e</span></tt> or
<tt class="docutils literal"><span class="pre">except</span> <span class="pre">(ValueError,TypeError),</span> <span class="pre">e</span></tt>, which is dangerous because it&#8217;s easy to
instead accidentally do something like <tt class="docutils literal"><span class="pre">except</span> <span class="pre">ValueError,TypeError</span></tt>, which
won&#8217;t catch <tt class="xref py py-obj docutils literal"><span class="pre">TypeError</span></tt>.</p>
</div>
</div>
<div class="section" id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline">¶</a></h2>
<p>Further tips and hints relating to the coding guidelines are included below.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="codeguide_emacs.html">Emacs setup for following coding guidelines</a></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">


<h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Coding Guidelines</a><ul>
<li><a class="reference internal" href="#interface-and-dependencies">Interface and Dependencies</a></li>
<li><a class="reference internal" href="#documentation-and-testing">Documentation and Testing</a></li>
<li><a class="reference internal" href="#data-and-configuration">Data and Configuration</a></li>
<li><a class="reference internal" href="#standard-output-warnings-and-errors">Standard output, warnings, and errors</a></li>
<li><a class="reference internal" href="#coding-style-conventions">Coding Style/Conventions</a></li>
<li><a class="reference internal" href="#including-c-code">Including C Code</a></li>
<li><a class="reference internal" href="#requirements-specific-to-affiliated-packages">Requirements Specific to Affiliated Packages</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#properties-vs-get-set">Properties vs. get_/set_</a></li>
<li><a class="reference internal" href="#super-vs-direct-calling">super() vs. Direct Calling</a></li>
<li><a class="reference internal" href="#acceptable-use-of-from-module-import">Acceptable use of <tt class="docutils literal"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span> <span class="pre">*</span></tt></a></li>
<li><a class="reference internal" href="#try-except-block-as-syntax">try...except block &#8220;as&#8221; syntax</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-resources">Additional Resources</a><ul>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>

<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/v0.2.1/docs/development/codeguide.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/development/codeguide.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2013, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3+. &nbsp;
    Last built 03 Apr 2013. <br/>
  </p>
</footer>
 <!-- End original user content -->


<br>
<br>
<br>


<style type="text/css">
  .rtd-badge {
    position: fixed;
    display: block;
    bottom: 5px;
    height: 40px;
    text-indent: -9999em;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
  }
  #version_menu {
    position: fixed;
    display: none;
    bottom: 11px;
    right: 166px;
    list-style-type: none;
    margin: 0;
  }
  .footer_popout:hover #version_menu {
    display: block;
  }
  #version_menu li {
    display: block;
    float: right;
  }
  #version_menu li a {
    display: block;
    padding: 6px 10px 4px 10px;
    margin: 7px 7px 0 0;
    font-weight: bold;
    font-size: 14px;
    height: 20px;
    line-height: 17px;
    text-decoration: none;
    color: #fff;
    background: #8ca1af url(../images/gradient-light.png) bottom left repeat-x;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 1px #465158;
    -moz-box-shadow: 0 1px 1px #465158;
    -webkit-box-shadow: 0 1px 1px #465158;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
  }
  #version_menu li a:hover {
    text-decoration: none;
    background-color: #697983;
    box-shadow: 0 1px 0px #465158;
    -moz-box-shadow: 0 1px 0px #465158;
    -webkit-box-shadow: 0 1px 0px #465158;
  }
  .rtd-badge.rtd {
    background: #3b4449 url(//media.readthedocs.org//images/badge-rtd.png) scroll 0px -46px no-repeat;
    border: 1px solid #282E32;
    width: 41px;
    right: 5px;
  }
  .footer_popout:hover .rtd-badge.rtd {
    background-position: top left;
    width: 160px;
  }
  .rtd-badge.revsys { background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline-sponsored {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys-sm.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 205px;
    right: 173px;
  }

</style>
<div class="rtd_doc_footer">
  <div class="footer_popout">
    <a href="//readthedocs.org/projects/astropy/?fromdocs=astropy" class="rtd-badge rtd"> Brought to you by Read the Docs</a>
    <ul id="version_menu">
      
        <li><a href="/en/latest/">latest</a></li>
      
        <li><a href="/en/add-mpl-to-rtd-pip-req/">add-mpl-to-rtd-pip-req</a></li>
      
        <li><a href="/en/v0.2.1/">v0.2.1</a></li>
      
        <li><a href="/en/v0.2/">v0.2</a></li>
      
        <li><a href="/en/v0.1/">v0.1</a></li>
      
    </ul>
  </div>
</div>
<!-- RTD Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<!-- User Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30968842-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>