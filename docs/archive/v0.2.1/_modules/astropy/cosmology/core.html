
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>astropy.cosmology.core &mdash; Astropy v0.2.1</title>
<!-- RTD <head> -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/underscore.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/doctools.js"></script>

<script type="text/javascript">
  // This is included here for Javascript that doesn't have access to the templates.
  var doc_version = "v0.2.1";
  var doc_slug = "astropy";
</script>

<script type="text/javascript" src="//media.readthedocs.org/javascript/rtd.js"></script>
<!-- end RTD <head> -->

    
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v0.2.1" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"></a>
  <ul>
    <li><a class="homelink" title="AstroPy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Python Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">Astropy v0.2.1</a>
	 &raquo;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for astropy.cosmology.core</h1><div class="highlight"><pre>
<span class="c"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="kn">from</span> <span class="nn">..config</span> <span class="kn">import</span> <span class="n">ConfigurationItem</span>
<span class="kn">from</span> <span class="nn">..utils.misc</span> <span class="kn">import</span> <span class="n">isiterable</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">parameters</span>

<span class="c"># Originally authored by Andrew Becker (becker@astro.washington.edu),</span>
<span class="c"># and modified by Neil Crighton (neilcrighton@gmail.com) and Roban</span>
<span class="c"># Kramer (robanhk@gmail.com).</span>

<span class="c"># Many of these adapted from Hogg 1999, astro-ph/9905116</span>
<span class="c"># and Linder 2003, PRL 90, 91301</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;FLRW&quot;</span><span class="p">,</span> <span class="s">&quot;LambdaCDM&quot;</span><span class="p">,</span> <span class="s">&quot;FlatLambdaCDM&quot;</span><span class="p">,</span> <span class="s">&quot;wCDM&quot;</span><span class="p">,</span> <span class="s">&quot;FlatwCDM&quot;</span><span class="p">,</span>
           <span class="s">&quot;Flatw0waCDM&quot;</span><span class="p">,</span> <span class="s">&quot;w0waCDM&quot;</span><span class="p">,</span> <span class="s">&quot;wpwaCDM&quot;</span><span class="p">,</span> <span class="s">&quot;w0wzCDM&quot;</span><span class="p">,</span><span class="s">&quot;get_current&quot;</span><span class="p">,</span>
           <span class="s">&quot;set_current&quot;</span><span class="p">,</span> <span class="s">&quot;WMAP5&quot;</span><span class="p">,</span> <span class="s">&quot;WMAP7&quot;</span><span class="p">,</span> <span class="s">&quot;WMAP9&quot;</span><span class="p">]</span>

<span class="c"># Constants</span>

<span class="c"># speed of light in km/s</span>
<span class="n">c_kms</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s">&#39;km/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="c"># Mpc in km</span>
<span class="n">Mpc_km</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="p">)</span>

<span class="c"># Gyr in seconds; note these are Julian years, which are defined</span>
<span class="c"># to be exactly 365.25 days of 86400 seconds each. If we used the units</span>
<span class="c"># framework, the days would be 365.242... days.</span>
<span class="n">Gyr</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span>

<span class="n">arcsec_in_radians</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">3600.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
<span class="n">arcmin_in_radians</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">60.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>


<span class="c">#Radiation parameter over c^2</span>
<span class="n">a_B_c2</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span><span class="o">**</span><span class="mi">3</span>

<span class="n">DEFAULT_COSMOLOGY</span> <span class="o">=</span> <span class="n">ConfigurationItem</span><span class="p">(</span>
    <span class="s">&#39;default_cosmology&#39;</span><span class="p">,</span> <span class="s">&#39;no_default&#39;</span><span class="p">,</span>
    <span class="s">&#39;The default cosmology to use. Note this is only read on import, &#39;</span>
    <span class="s">&#39;changing this value at runtime has no effect.&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CosmologyError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Cosmology</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Placeholder for when a more general Cosmology class is</span>
<span class="sd">    implemented. &quot;&quot;&quot;</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="FLRW"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW">[docs]</a><span class="k">class</span> <span class="nc">FLRW</span><span class="p">(</span><span class="n">Cosmology</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A class describing an isotropic and homogeneous</span>
<span class="sd">    (Friedmann-Lemaitre-Robertson-Walker) cosmology.</span>

<span class="sd">    This is an abstract base class -- you can&#39;t instantiate</span>
<span class="sd">    examples of this class, but must work with one of its</span>
<span class="sd">    subclasses such as `LambdaCDM` or `wCDM`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Class instances are static -- you can&#39;t change the values</span>
<span class="sd">    of the parameters.  That is, all of the attributes above are</span>
<span class="sd">    read only.</span>

<span class="sd">    The neutrino treatment assumes all neutrino species are massless.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;FLRW&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ode0 : float</span>
<span class="sd">          Omega dark energy: density of dark energy in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># all densities are in units of the critical density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Om0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Ode0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Tcmb0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Neff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c"># Hubble parameter at z=0, km/s/Mpc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">H0</span><span class="p">)</span>
        <span class="c"># H0 in s^-1</span>
        <span class="n">H0_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span> <span class="o">/</span> <span class="n">Mpc_km</span>
        <span class="c"># 100 km/s/Mpc * h = H0 (so h is dimensionless)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span> <span class="o">/</span> <span class="mf">100.</span>
        <span class="c"># Hubble time in Gyr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">H0_s</span> <span class="o">/</span> <span class="n">Gyr</span>
        <span class="c"># Hubble distance in Mpc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span> <span class="o">=</span> <span class="n">c_kms</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span>

        <span class="c"># critical density at z=0 (grams per cubic cm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span> <span class="o">=</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">H0_s</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">G</span><span class="o">.</span><span class="n">cgs</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="c"># Compute photon density, Tcmb, neutrino parameters</span>
        <span class="c"># Tcmb0=0 removes both photons and neutrinos, is handled</span>
        <span class="c"># as a special case for efficiency</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Compute photon density from Tcmb</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">=</span> <span class="n">a_B_c2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span>

            <span class="c">#Compute Neutrino Omega</span>
            <span class="c"># The constant in front is 7/8 (4/11)^4/3 -- see any</span>
            <span class="c">#  cosmology book for an explanation; the 7/8 is FD vs. BE</span>
            <span class="c">#  statistics, the 4/11 is the temperature effect</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">=</span> <span class="mf">0.2271073</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c">#Compute curvature density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, Ok0=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">)</span>

    <span class="c">#Set up a set of properties for H0, Om0, Ode0, Ok0, etc. for user access.</span>
    <span class="c">#Note that we don&#39;t let these be set (so, obj.Om0 = value fails)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.H0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.H0">[docs]</a>    <span class="k">def</span> <span class="nf">H0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the Hubble constant in [km/sec/Mpc] at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Om0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Om0">[docs]</a>    <span class="k">def</span> <span class="nf">Om0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega matter; matter density/critical density at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Ode0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Ode0">[docs]</a>    <span class="k">def</span> <span class="nf">Ode0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega dark energy; dark energy density/critical density at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Ok0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Ok0">[docs]</a>    <span class="k">def</span> <span class="nf">Ok0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega curvature; the effective curvature density/critical density</span>
<span class="sd">        at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Tcmb0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Tcmb0">[docs]</a>    <span class="k">def</span> <span class="nf">Tcmb0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Temperature of the CMB in Kelvin at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Neff"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Neff">[docs]</a>    <span class="k">def</span> <span class="nf">Neff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Number of effective neutrino species&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.h"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.h">[docs]</a>    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dimensionless Hubble constant: h = H_0 / 100 [km/sec/Mpc]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.hubble_time"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.hubble_time">[docs]</a>    <span class="k">def</span> <span class="nf">hubble_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Hubble time in [Gyr]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.hubble_distance"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.hubble_distance">[docs]</a>    <span class="k">def</span> <span class="nf">hubble_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Hubble distance in [Mpc]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.critical_density0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.critical_density0">[docs]</a>    <span class="k">def</span> <span class="nf">critical_density0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Critical density in [g cm^-3] at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Ogamma0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Ogamma0">[docs]</a>    <span class="k">def</span> <span class="nf">Ogamma0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega gamma; the density/critical density of photons at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="FLRW.Onu0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Onu0">[docs]</a>    <span class="k">def</span> <span class="nf">Onu0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega nu; the density/critical density of neutrinos at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
</div>
    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="FLRW.w"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The dark energy equation of state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.</span>

<span class="sd">        This must be overridden by subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;w(z) is not implemented&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.Om"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Om">[docs]</a>    <span class="k">def</span> <span class="nf">Om</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for non-relativistic matter</span>
<span class="sd">        at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Om : ndarray, or float if input scalar</span>
<span class="sd">          The density of non-relativistic matter relative to the critical</span>
<span class="sd">          density at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ok"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Ok">[docs]</a>    <span class="k">def</span> <span class="nf">Ok</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the equivalent density parameter for curvature</span>
<span class="sd">        at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ok : ndarray, or float if input scalar</span>
<span class="sd">          The equivalent density parameter for curvature at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c">#Common enough case to be worth checking</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ode"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Ode">[docs]</a>    <span class="k">def</span> <span class="nf">Ode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for dark energy at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ode : ndarray, or float if input scalar</span>
<span class="sd">          The density of non-relativistic matter relative to the critical</span>
<span class="sd">          density at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_density_scale</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ogamma"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Ogamma">[docs]</a>    <span class="k">def</span> <span class="nf">Ogamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for photons at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ogamma : ndarray, or float if input scalar</span>
<span class="sd">          The energy density of photons relative to the critical</span>
<span class="sd">          density at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c">#Common enough case to be worth checking (although it clearly</span>
            <span class="c"># doesn&#39;t represent any real universe)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Onu"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Onu">[docs]</a>    <span class="k">def</span> <span class="nf">Onu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for massless neutrinos at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Onu : ndarray, or float if input scalar</span>
<span class="sd">          The energy density of photons relative to the critical</span>
<span class="sd">          density at each redshift.  Note that this includes only</span>
<span class="sd">          their relativistic energy, since they are assumed massless.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c">#Common enough case to be worth checking (although it clearly</span>
            <span class="c"># doesn&#39;t represent any real universe)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Tcmb"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.Tcmb">[docs]</a>    <span class="k">def</span> <span class="nf">Tcmb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the CMB temperature at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tcmb : ndarray, or float if z is scalar</span>
<span class="sd">          The temperature of the CMB in K.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_w_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln1pz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Internal convenience function for w(z) integral.&quot;&quot;&quot;</span>

        <span class="c">#See Linder 2003, PRL 90, 91301 eq (5)</span>
        <span class="c">#Assumes scalar input, since this should only be called</span>
        <span class="c"># inside an integral</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">ln1pz</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<div class="viewcode-block" id="FLRW.de_density_scale"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">            I = \\exp \\left( 3 \int_{a}^1 \\frac{ da^{\\prime} }{ a^{\\prime} }</span>
<span class="sd">            \\left[ 1 + w\\left( a^{\\prime} \\right) \\right] \\right)</span>

<span class="sd">        It will generally helpful for subclasses to overload this method if</span>
<span class="sd">        the integral can be done analytically for the particular dark</span>
<span class="sd">        energy equation of state that they implement.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># This allows for an arbitrary w(z) following eq (5) of</span>
        <span class="c"># Linder 2003, PRL 90, 91301.  The code here evaluates</span>
        <span class="c"># the integral numerically.  However, most popular</span>
        <span class="c"># forms of w(z) are designed to make this integral analytic,</span>
        <span class="c"># so it is probably a good idea for subclasses to overload this</span>
        <span class="c"># method if an analytic form is available.</span>
        <span class="c">#</span>
        <span class="c"># The integral we actually use (the one given in Linder)</span>
        <span class="c"># is rewritten in terms of z, so looks slightly different than the</span>
        <span class="c"># one in the documentation string, but it&#39;s the same thing.</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">ival</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_w_integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">redshift</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                             <span class="k">for</span> <span class="n">redshift</span> <span class="ow">in</span> <span class="n">z</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ival</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ival</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_w_integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ival</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>

<span class="sd">        It is not necessary to override this method, but if de_density_scale</span>
<span class="sd">        takes a particularly simple form, it may be advantageous to.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">Ode0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_density_scale</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="FLRW.inv_efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inverse of efunc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the inverse Hubble constant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c">#Avoid the function overhead by repeating code</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                           <span class="n">Ode0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_density_scale</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">_tfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the lookback time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The integrand for the lookback time</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Eqn 30 from Hogg 1999.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">zp1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_xfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the absorption distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X : ndarray, or float if input scalar</span>
<span class="sd">          The integrand for the absorption distance</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        See Hogg 1999 section 11.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<div class="viewcode-block" id="FLRW.H"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.H">[docs]</a>    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Hubble parameter (km/s/Mpc) at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        H : ndarray, or float if input scalar</span>
<span class="sd">          Hubble parameter in km/s/Mpc at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.scale_factor"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.scale_factor">[docs]</a>    <span class="k">def</span> <span class="nf">scale_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Scale factor at redshift `z`.</span>

<span class="sd">        The scale factor is defined as :math:`a = 1 / (1 + z)`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a : ndarray, or float if input scalar</span>
<span class="sd">          Scale factor at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="FLRW.lookback_time"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.lookback_time">[docs]</a>    <span class="k">def</span> <span class="nf">lookback_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Lookback time in Gyr to redshift `z`.</span>

<span class="sd">        The lookback time is the difference between the age of the</span>
<span class="sd">        Universe now and the age at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        t : ndarray, or float if input scalar</span>
<span class="sd">          Lookback time in Gyr to each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">*</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tfunc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tfunc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">redshift</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">redshift</span> <span class="ow">in</span> <span class="n">z</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.age"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.age">[docs]</a>    <span class="k">def</span> <span class="nf">age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Age of the universe in Gyr at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        t : ndarray, or float if input scalar</span>
<span class="sd">          The age of the universe in Gyr at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">*</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tfunc</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tfunc</span><span class="p">,</span> <span class="n">redshift</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">redshift</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.critical_density"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.critical_density">[docs]</a>    <span class="k">def</span> <span class="nf">critical_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Critical density in grams per cubic cm at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        rho : ndarray, or float if input scalar</span>
<span class="sd">          Critical density in g/cm^3 at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.comoving_distance"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.comoving_distance">[docs]</a>    <span class="k">def</span> <span class="nf">comoving_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving line-of-sight distance in Mpc at a given</span>
<span class="sd">        redshift.</span>

<span class="sd">        The comoving distance along the line-of-sight between two</span>
<span class="sd">        objects remains constant with time for objects in the Hubble</span>
<span class="sd">        flow.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          Comoving distance in Mpc to each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span> <span class="o">*</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">redshift</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">redshift</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.comoving_transverse_distance"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.comoving_transverse_distance">[docs]</a>    <span class="k">def</span> <span class="nf">comoving_transverse_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving transverse distance in Mpc at a given redshift.</span>

<span class="sd">        This value is the transverse comoving distance at redshift `z`</span>
<span class="sd">        corresponding to an angular separation of 1 radian. This is</span>
<span class="sd">        the same as the comoving distance if omega_k is zero (as in</span>
<span class="sd">        the current concordance lambda CDM model).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          Comoving transverse distance in Mpc at each input redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This quantity also called the &#39;proper motion distance&#39; in some</span>
<span class="sd">        texts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dc</span>
        <span class="n">sqrtOk0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span>
        <span class="n">dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dh</span> <span class="o">/</span> <span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">dc</span> <span class="o">/</span> <span class="n">dh</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dh</span> <span class="o">/</span> <span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">dc</span> <span class="o">/</span> <span class="n">dh</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.angular_diameter_distance"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.angular_diameter_distance">[docs]</a>    <span class="k">def</span> <span class="nf">angular_diameter_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular diameter distance in Mpc at a given redshift.</span>

<span class="sd">        This gives the proper (sometimes called &#39;physical&#39;) transverse</span>
<span class="sd">        distance corresponding to an angle of 1 radian for an object</span>
<span class="sd">        at redshift `z`.</span>

<span class="sd">        Weinberg, 1972, pp 421-424; Weedman, 1986, pp 65-67; Peebles,</span>
<span class="sd">        1993, pp 325-327.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          Angular diameter distance in Mpc at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.luminosity_distance"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.luminosity_distance">[docs]</a>    <span class="k">def</span> <span class="nf">luminosity_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Luminosity distance in Mpc at redshift `z`.</span>

<span class="sd">        This is the distance to use when converting between the</span>
<span class="sd">        bolometric flux from an object at redshift `z` and its</span>
<span class="sd">        bolometric luminosity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          Luminosity distance in Mpc at each input redshift.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Weinberg, 1972, pp 420-424; Weedman, 1986, pp 60-62.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.angular_diameter_distance_z1z2"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.angular_diameter_distance_z1z2">[docs]</a>    <span class="k">def</span> <span class="nf">angular_diameter_distance_z1z2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular diameter distance between objects at 2 redshifts.</span>
<span class="sd">        Useful for gravitational lensing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z1, z2 : array_like, shape (N,)</span>
<span class="sd">          Input redshifts. z2 must be large than z1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, shape (N,) or float if input scalar</span>
<span class="sd">          The angular diameter distance between each input redshift</span>
<span class="sd">          pair.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        CosmologyError</span>
<span class="sd">          If omega_k is &lt; 0.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method only works for flat or open curvature</span>
<span class="sd">        (omega_k &gt;= 0).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># does not work for negative curvature</span>
        <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CosmologyError</span><span class="p">(</span><span class="s">&#39;Ok0 must be &gt;= 0 to use this method.&#39;</span><span class="p">)</span>

        <span class="n">outscalar</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z2</span><span class="p">):</span>
            <span class="n">outscalar</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">z1</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">z2</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;z1 and z2 must be the same size.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">z1</span> <span class="o">&gt;</span> <span class="n">z2</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;z2 must greater than z1&#39;</span><span class="p">)</span>

        <span class="c"># z1 &lt; z2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">z2</span> <span class="o">&lt;</span> <span class="n">z1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">z2</span><span class="p">,</span> <span class="n">z1</span>

        <span class="n">dm1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
        <span class="n">dm2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
        <span class="n">dh_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span><span class="o">**</span><span class="mi">2</span>

        <span class="n">out</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dm2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">Ok0</span><span class="o">*</span><span class="n">dm1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dh_2</span><span class="p">)</span> <span class="o">-</span>
                                <span class="n">dm1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">Ok0</span><span class="o">*</span><span class="n">dm2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dh_2</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">outscalar</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="FLRW.absorption_distance"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.absorption_distance">[docs]</a>    <span class="k">def</span> <span class="nf">absorption_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Absorption distance at redshift `z`.</span>

<span class="sd">        This is used to calculate the number of objects with some</span>
<span class="sd">        cross section of absorption and number density intersecting a</span>
<span class="sd">        sightline per unit redshift path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          Absorption distance (dimensionless) at each input redshift.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Hogg 1999 Section 11. (astro-ph/9905116)</span>
<span class="sd">        Bahcall, John N. and Peebles, P.J.E. 1969, ApJ, 156L, 7B</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xfunc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xfunc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">redshift</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">redshift</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.distmod"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.distmod">[docs]</a>    <span class="k">def</span> <span class="nf">distmod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Distance modulus at redshift `z`.</span>

<span class="sd">        The distance modulus is defined as the (apparent magnitude -</span>
<span class="sd">        absolute magnitude) for an object at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        distmod : ndarray, or float if input scalar</span>
<span class="sd">          Distance modulus at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Remember that the luminosity distance is in Mpc</span>
        <span class="k">return</span> <span class="mf">5.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">luminosity_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.e5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.comoving_volume"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.comoving_volume">[docs]</a>    <span class="k">def</span> <span class="nf">comoving_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving volume in cubic Mpc at redshift `z`.</span>

<span class="sd">        This is the volume of the universe encompassed by redshifts</span>
<span class="sd">        less than `z`. For the case of omega_k = 0 it is a sphere of</span>
<span class="sd">        radius `comoving_distance(z)` but it is less intuitive if</span>
<span class="sd">        omega_k is not 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        V : ndarray, or float if input scalar</span>
<span class="sd">          Comoving volume in Mpc^3 at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">4.</span> <span class="o">/</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

        <span class="n">dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span>
        <span class="n">dm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">dh</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">Ok0</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">/</span> <span class="n">dh</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Ok0</span> <span class="o">*</span> <span class="p">(</span><span class="n">dm</span> <span class="o">/</span> <span class="n">dh</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">term3</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span> <span class="o">*</span> <span class="n">dm</span> <span class="o">/</span> <span class="n">dh</span>

        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">term1</span> <span class="o">*</span> <span class="p">(</span><span class="n">term2</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="n">term3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">term1</span> <span class="o">*</span> <span class="p">(</span><span class="n">term2</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">term3</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="FLRW.kpc_comoving_per_arcmin"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.kpc_comoving_per_arcmin">[docs]</a>    <span class="k">def</span> <span class="nf">kpc_comoving_per_arcmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Separation in transverse comoving kpc corresponding to an</span>
<span class="sd">        arcminute at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          The distance in comoving kpc corresponding to an arcmin at each</span>
<span class="sd">          input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.e3</span> <span class="o">*</span> <span class="n">arcmin_in_radians</span>

</div>
<div class="viewcode-block" id="FLRW.kpc_proper_per_arcmin"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.kpc_proper_per_arcmin">[docs]</a>    <span class="k">def</span> <span class="nf">kpc_proper_per_arcmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Separation in transverse proper kpc corresponding to an</span>
<span class="sd">        arcminute at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : ndarray, or float if input scalar</span>
<span class="sd">          The distance in proper kpc corresponding to an arcmin at each</span>
<span class="sd">          input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.e3</span> <span class="o">*</span> <span class="n">arcmin_in_radians</span>

</div>
<div class="viewcode-block" id="FLRW.arcsec_per_kpc_comoving"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.arcsec_per_kpc_comoving">[docs]</a>    <span class="k">def</span> <span class="nf">arcsec_per_kpc_comoving</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular separation in arcsec corresponding to a comoving kpc</span>
<span class="sd">        at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : ndarray, or float if input scalar</span>
<span class="sd">          The angular separation in arcsec corresponding to a comoving kpc</span>
<span class="sd">          at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span>
                    <span class="mf">1.e3</span> <span class="o">*</span> <span class="n">arcsec_in_radians</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="FLRW.arcsec_per_kpc_proper"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FLRW.html#astropy.cosmology.core.FLRW.arcsec_per_kpc_proper">[docs]</a>    <span class="k">def</span> <span class="nf">arcsec_per_kpc_proper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular separation in arcsec corresponding to a proper kpc at</span>
<span class="sd">        redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : ndarray, or float if input scalar</span>
<span class="sd">          The angular separation in arcsec corresponding to a proper kpc</span>
<span class="sd">          at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.e3</span> <span class="o">*</span>
                    <span class="n">arcsec_in_radians</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="LambdaCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.LambdaCDM.html#astropy.cosmology.core.LambdaCDM">[docs]</a><span class="k">class</span> <span class="nc">LambdaCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a cosmological constant and curvature.</span>

<span class="sd">    This has no additional attributes beyond those of FLRW.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import LambdaCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = LambdaCDM(H0=70, Om0=0.3, Ode0=0.7)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="s">&#39;LambdaCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ode0 : float</span>
<span class="sd">          Omega dark energy: density of the cosmological constant in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="LambdaCDM.w"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.LambdaCDM.html#astropy.cosmology.core.LambdaCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = -1`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LambdaCDM.de_density_scale"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.LambdaCDM.html#astropy.cosmology.core.LambdaCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by :math:`I = 1`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LambdaCDM.efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.LambdaCDM.html#astropy.cosmology.core.LambdaCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble consant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c">#We override this because it takes a particularly simple</span>
        <span class="c"># form for a cosmological constant</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LambdaCDM.inv_efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.LambdaCDM.html#astropy.cosmology.core.LambdaCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 /</span>
<span class="sd">        E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="FlatLambdaCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FlatLambdaCDM.html#astropy.cosmology.core.FlatLambdaCDM">[docs]</a><span class="k">class</span> <span class="nc">FlatLambdaCDM</span><span class="p">(</span><span class="n">LambdaCDM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a cosmological constant and no curvature.</span>

<span class="sd">    This has no additional attributes beyond those of FLRW.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import FlatLambdaCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = FlatLambdaCDM(H0=70, Om0=0.3)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;FlatLambdaCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="c">#Do some twiddling after the fact to get flatness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">)</span>


<div class="viewcode-block" id="FlatLambdaCDM.efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FlatLambdaCDM.html#astropy.cosmology.core.FlatLambdaCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble consant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c">#We override this because it takes a particularly simple</span>
        <span class="c"># form for a cosmological constant</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FlatLambdaCDM.inv_efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FlatLambdaCDM.html#astropy.cosmology.core.FlatLambdaCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 / E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="wCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wCDM.html#astropy.cosmology.core.wCDM">[docs]</a><span class="k">class</span> <span class="nc">wCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a constant dark energy equation of state</span>
<span class="sd">    and curvature.</span>

<span class="sd">    This has one additional attribute beyond those of FLRW.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import wCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = wCDM(H0=70, Om0=0.3, Ode0=0.7, w0=-0.9)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;wCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ode0 : float</span>
<span class="sd">          Omega dark energy: density of dark energy in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        w0 : float</span>
<span class="sd">          Dark energy equation of state at all redshifts.</span>
<span class="sd">          This is pressure/density for dark energy in units where c=1.</span>
<span class="sd">          A cosmological constant has w0=-1.0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, Ok0=</span><span class="si">%.3g</span><span class="s">, w0=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="wCDM.w0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wCDM.html#astropy.cosmology.core.wCDM.w0">[docs]</a>    <span class="k">def</span> <span class="nf">w0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
</div>
<div class="viewcode-block" id="wCDM.w"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wCDM.html#astropy.cosmology.core.wCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = w_0`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="wCDM.de_density_scale"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wCDM.html#astropy.cosmology.core.wCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>
<span class="sd">        :math:`I = \\left(1 + z\\right)^{3\\left(1 + w_0\\right)}`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="wCDM.efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wCDM.html#astropy.cosmology.core.wCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble consant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="wCDM.inv_efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wCDM.html#astropy.cosmology.core.wCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 / E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                             <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span>

</div></div>
<div class="viewcode-block" id="FlatwCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FlatwCDM.html#astropy.cosmology.core.FlatwCDM">[docs]</a><span class="k">class</span> <span class="nc">FlatwCDM</span><span class="p">(</span><span class="n">wCDM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a constant dark energy equation of state</span>
<span class="sd">    and no spatial curvature.</span>

<span class="sd">    This has one additional attribute beyond those of FLRW.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import FlatwCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = FlatwCDM(H0=70, Om0=0.3, w0=-0.9)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;FlatwCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        w0 : float</span>
<span class="sd">          Dark energy equation of state at all redshifts.</span>
<span class="sd">          This is pressure/density for dark energy in units where c=1.</span>
<span class="sd">          A cosmological constant has w0=-1.0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name: string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="c">#Do some twiddling after the fact to get flatness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, w0=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>

<div class="viewcode-block" id="FlatwCDM.efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FlatwCDM.html#astropy.cosmology.core.FlatwCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble consant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="FlatwCDM.inv_efunc"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.FlatwCDM.html#astropy.cosmology.core.FlatwCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 / E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="n">Or0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span>
                             <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span>
</div></div>
<div class="viewcode-block" id="w0waCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0waCDM.html#astropy.cosmology.core.w0waCDM">[docs]</a><span class="k">class</span> <span class="nc">w0waCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a CPL dark energy equation of state and curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    CPL form as described in Chevallier &amp; Polarski Int. J. Mod. Phys.</span>
<span class="sd">    D10, 213 (2001) and Linder PRL 90, 91301 (2003):</span>
<span class="sd">    :math:`w(z) = w_0 + w_a (1-a) = w_0 + w_a z / (1+z)`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import w0waCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = w0waCDM(H0=70, Om0=0.3, Ode0=0.7, w0=-0.9, wa=0.2)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;w0waCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ode0 : float</span>
<span class="sd">          Omega dark energy: density of dark energy in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        w0 : float</span>
<span class="sd">          Dark energy equation of state at z=0 (a=1).</span>
<span class="sd">          This is pressure/density for dark energy in units where c=1.</span>

<span class="sd">        wa : float</span>
<span class="sd">          Negative derivative of the dark energy equation of state</span>
<span class="sd">          with respect to the scale factor.  A cosmological constant has</span>
<span class="sd">          w0=-1.0 and wa=0.0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wa</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, Ok0=</span><span class="si">%.3g</span><span class="s">, w0=</span><span class="si">%.3g</span><span class="s">, wa=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span>\
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="w0waCDM.w0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0waCDM.html#astropy.cosmology.core.w0waCDM.w0">[docs]</a>    <span class="k">def</span> <span class="nf">w0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="w0waCDM.wa"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0waCDM.html#astropy.cosmology.core.w0waCDM.wa">[docs]</a>    <span class="k">def</span> <span class="nf">wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Negative derivative of dark energy equation of state w.r.t. a&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span>
</div>
<div class="viewcode-block" id="w0waCDM.w"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0waCDM.html#astropy.cosmology.core.w0waCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = w_0 + w_a (1 - a) = w_0 + w_a \\frac{z}{1+z}`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="w0waCDM.de_density_scale"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0waCDM.html#astropy.cosmology.core.w0waCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          I = \\left(1 + z\\right)^{3 \\left(1 + w_0 + w_a\\right)}</span>
<span class="sd">          \exp \\left(-3 w_a \\frac{z}{1+z}\\right)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">))</span> <span class="o">*</span> \
            <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="n">z</span> <span class="o">/</span> <span class="n">zp1</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="Flatw0waCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.Flatw0waCDM.html#astropy.cosmology.core.Flatw0waCDM">[docs]</a><span class="k">class</span> <span class="nc">Flatw0waCDM</span><span class="p">(</span><span class="n">w0waCDM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a CPL dark energy equation of state and no curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    CPL form as described in Chevallier &amp; Polarski Int. J. Mod. Phys.</span>
<span class="sd">    D10, 213 (2001) and Linder PRL 90, 91301 (2003):</span>
<span class="sd">    :math:`w(z) = w_0 + w_a (1-a) = w_0 + w_a z / (1+z)`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import Flatw0waCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = Flatw0waCDM(H0=70, Om0=0.3, w0=-0.9, wa=0.2)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;Flatw0waCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        w0 : float</span>
<span class="sd">          Dark energy equation of state at z=0 (a=1).</span>
<span class="sd">          This is pressure/density for dark energy in units where c=1.</span>

<span class="sd">        wa : float</span>
<span class="sd">          Negative derivative of the dark energy equation of state</span>
<span class="sd">          with respect to the scale factor.  A cosmological constant has</span>
<span class="sd">          w0=-1.0 and wa=0.0.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="c">#Do some twiddling after the fact to get flatness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wa</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, w0=</span><span class="si">%.3g</span><span class="s">, wa=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span>\
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="wpwaCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wpwaCDM.html#astropy.cosmology.core.wpwaCDM">[docs]</a><span class="k">class</span> <span class="nc">wpwaCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a CPL dark energy equation of state, a pivot</span>
<span class="sd">    redshift, and curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    CPL form as described in Chevallier &amp; Polarski Int. J. Mod. Phys.</span>
<span class="sd">    D10, 213 (2001) and Linder PRL 90, 91301 (2003), but modified</span>
<span class="sd">    to have a pivot redshift as in the findings of the Dark Energy</span>
<span class="sd">    Task Force (Albrecht et al. arXiv:0901.0721 (2009)):</span>
<span class="sd">    :math:`w(a) = w_p + w_a (a_p - a) = w_p + w_a( 1/(1+zp) - 1/(1+z) )`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import wpwaCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = wpwaCDM(H0=70,Om0=0.3,Ode0=0.7,wp=-0.9,wa=0.2,zp=0.4)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">wp</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">zp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;wpwaCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ode0 : float</span>
<span class="sd">          Omega dark energy: density of dark energy in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        wp : float</span>
<span class="sd">          Dark energy equation of state at the pivot redshift zp.</span>
<span class="sd">          This is pressure/density for dark energy in units where c=1.</span>

<span class="sd">        wa : float</span>
<span class="sd">          Negative derivative of the dark energy equation of state</span>
<span class="sd">          with respect to the scale factor.  A cosmological constant</span>
<span class="sd">          has w0=-1.0 and wa=0.0.</span>

<span class="sd">        zp : float</span>
<span class="sd">          Pivot redshift -- the redshift where w(z) = wp</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wa</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">str</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, Ok0=</span><span class="si">%.3g</span><span class="s">, wp=</span><span class="si">%.3g</span><span class="s">, &quot;</span><span class="o">+</span>\
            <span class="s">&quot;wa=</span><span class="si">%.3g</span><span class="s">, zp=</span><span class="si">%.3g</span><span class="s">)&quot;</span>
        <span class="k">return</span> <span class="nb">str</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="wpwaCDM.wp"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wpwaCDM.html#astropy.cosmology.core.wpwaCDM.wp">[docs]</a>    <span class="k">def</span> <span class="nf">wp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state at the pivot redshift zp&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="wpwaCDM.wa"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wpwaCDM.html#astropy.cosmology.core.wpwaCDM.wa">[docs]</a>    <span class="k">def</span> <span class="nf">wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Negative derivative of dark energy equation of state w.r.t. a&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="wpwaCDM.zp"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wpwaCDM.html#astropy.cosmology.core.wpwaCDM.zp">[docs]</a>    <span class="k">def</span> <span class="nf">zp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The pivot redshift, where w(z) = wp&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span>
</div>
<div class="viewcode-block" id="wpwaCDM.w"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wpwaCDM.html#astropy.cosmology.core.wpwaCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = w_p + w_a (a_p - a)` where :math:`a = 1/1+z`</span>
<span class="sd">        and :math:`a_p = 1 / 1 + z_p`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">apiv</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="p">(</span><span class="n">apiv</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="wpwaCDM.de_density_scale"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.wpwaCDM.html#astropy.cosmology.core.wpwaCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          a_p = \\frac{1}{1 + z_p}</span>

<span class="sd">          I = \\left(1 + z\\right)^{3 \\left(1 + w_p + a_p w_a\\right)}</span>
<span class="sd">          \exp \\left(-3 w_a \\frac{z}{1+z}\\right)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>
        <span class="n">apiv</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span> <span class="o">+</span> <span class="n">apiv</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">))</span> <span class="o">*</span> \
            <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="n">z</span> <span class="o">/</span> <span class="n">zp1</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="w0wzCDM"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0wzCDM.html#astropy.cosmology.core.w0wzCDM">[docs]</a><span class="k">class</span> <span class="nc">w0wzCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a variable dark energy equation of state</span>
<span class="sd">    and curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    simple form: :math:`w(z) = w_0 + w_z z`.</span>

<span class="sd">    This form is not recommended for z &gt; 1.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astro.cosmology import wawzCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = wawzCDM(H0=70, Om0=0.3, Ode0=0.7, w0=-0.9, wz=0.2)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wz</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;w0wzCDM&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        H0 : float</span>
<span class="sd">          Hubble constant in [km/sec/Mpc] at z=0</span>

<span class="sd">        Om0 : float</span>
<span class="sd">          Omega matter: density of non-relativistic matter in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ode0 : float</span>
<span class="sd">          Omega dark energy: density of dark energy in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        Ok0 : float</span>
<span class="sd">          Omega curvature: equivalent curvature density in units</span>
<span class="sd">          of the critical density at z=0.</span>

<span class="sd">        w0 : float</span>
<span class="sd">          Dark energy equation of state at z=0.</span>
<span class="sd">          This is pressure/density for dark energy in units where c=1.</span>
<span class="sd">          A cosmological constant has w0=-1.0.</span>

<span class="sd">        wz : float</span>
<span class="sd">          Derivative of the dark energy equation of state with respect to z.</span>

<span class="sd">        Tcmb0 : float</span>
<span class="sd">          Temperature of the CMB in Kelvin at z=0 (def: 2.725)</span>

<span class="sd">        Neff : float</span>
<span class="sd">          Effective number of Neutrino species (def: 3.04)</span>

<span class="sd">        name : string</span>
<span class="sd">          Optional name for this cosmological object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wz</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">(H0=</span><span class="si">%.3g</span><span class="s">, Om0=</span><span class="si">%.3g</span><span class="s">, Ode0=</span><span class="si">%.3g</span><span class="s">, w0=</span><span class="si">%.3g</span><span class="s">, wz=</span><span class="si">%.3g</span><span class="s">)&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="w0wzCDM.w0"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0wzCDM.html#astropy.cosmology.core.w0wzCDM.w0">[docs]</a>    <span class="k">def</span> <span class="nf">w0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="w0wzCDM.wz"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0wzCDM.html#astropy.cosmology.core.w0wzCDM.wz">[docs]</a>    <span class="k">def</span> <span class="nf">wz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Derivative of the dark energy equation of state w.r.t. z&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span>
</div>
<div class="viewcode-block" id="w0wzCDM.w"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0wzCDM.html#astropy.cosmology.core.w0wzCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift `z`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is given by</span>
<span class="sd">        :math:`w(z) = w_0 + w_z z`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span> <span class="o">*</span> <span class="n">z</span>
</div>
<div class="viewcode-block" id="w0wzCDM.de_density_scale"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.w0wzCDM.html#astropy.cosmology.core.w0wzCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array_like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          I = \\left(1 + z\\right)^{3 \\left(1 + w_0 - w_z\\right)}</span>
<span class="sd">          \exp \\left(-3 w_z z\\right)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">))</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>

<span class="c"># Pre-defined cosmologies. This loops over the parameter sets in the</span>
<span class="c"># parameters module and creates a LambdaCDM or FlatLambdaCDM instance</span>
<span class="c"># with the same name as the parameter set in the current module&#39;s namespace.</span>
<span class="c"># Note this assumes all the cosmologies in parameters are LambdaCDM,</span>
<span class="c"># which is true at least as of this writing.</span>
</div></div>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">available</span><span class="p">:</span>
    <span class="n">par</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;flat&#39;</span><span class="p">]:</span>
        <span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;H0&#39;</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;Om0&#39;</span><span class="p">],</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Tcmb0&#39;</span><span class="p">],</span>
                              <span class="n">Neff</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Neff&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cosmo</span> <span class="o">=</span> <span class="n">LambdaCDM</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;H0&#39;</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;Om0&#39;</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;Ode0&#39;</span><span class="p">],</span>
                          <span class="n">Tcmb0</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Tcmb0&#39;</span><span class="p">],</span> <span class="n">Neff</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Neff&#39;</span><span class="p">],</span>
                          <span class="n">m_nu</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;m_nu&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="n">cosmo</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> cosmology</span><span class="se">\n\n</span><span class="s">(from </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;reference&#39;</span><span class="p">])</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">cosmo</span><span class="p">)</span>

<span class="c"># don&#39;t leave these variables floating around in the namespace</span>
<span class="k">del</span> <span class="n">key</span><span class="p">,</span> <span class="n">par</span><span class="p">,</span> <span class="n">cosmo</span>

<span class="c">#########################################################################</span>
<span class="c"># The variable below contains the current cosmology used by the</span>
<span class="c"># convenience functions below and by other astropy functions if no</span>
<span class="c"># cosmology is explicitly given. It can be set with set_current() and</span>
<span class="c"># should be accessed using get_current().</span>
<span class="c">#########################################################################</span>


<span class="k">def</span> <span class="nf">get_cosmology_from_string</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return a cosmology instance from a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s">&#39;no_default&#39;</span><span class="p">:</span>
        <span class="n">cosmo</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cosmo</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">],</span> <span class="n">arg</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;Unknown cosmology &#39;</span><span class="si">%s</span><span class="s">&#39;. Valid cosmologies:</span><span class="se">\n</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">arg</span><span class="p">,</span> <span class="n">parameters</span><span class="o">.</span><span class="n">available</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cosmo</span>

<span class="n">_current</span> <span class="o">=</span> <span class="n">get_cosmology_from_string</span><span class="p">(</span><span class="n">DEFAULT_COSMOLOGY</span><span class="p">())</span>


<div class="viewcode-block" id="get_current"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.get_current.html#astropy.cosmology.core.get_current">[docs]</a><span class="k">def</span> <span class="nf">get_current</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Get the current cosmology.</span>

<span class="sd">    If no current has been set, the WMAP7 comology is returned and a</span>
<span class="sd">    warning is given.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cosmo : `Cosmology` instance</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    set_current : sets the current cosmology</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">_current</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;No default cosmology has been specified, &#39;</span>
                      <span class="s">&#39;using 7-year WMAP.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">WMAP7</span>

    <span class="k">return</span> <span class="n">_current</span>

</div>
<div class="viewcode-block" id="set_current"><a class="viewcode-back" href="../../../_generated/astropy.cosmology.core.set_current.html#astropy.cosmology.core.set_current">[docs]</a><span class="k">def</span> <span class="nf">set_current</span><span class="p">(</span><span class="n">cosmo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Set the current cosmology.</span>

<span class="sd">    Call this with an empty string (&#39;&#39;) to get a list of the strings</span>
<span class="sd">    that map to available pre-defined cosmologies.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        `set_current` is the only way to change the current cosmology at</span>
<span class="sd">        runtime! The current cosmology can also be read from an option</span>
<span class="sd">        in the astropy configuration file when astropy.cosmology is first</span>
<span class="sd">        imported. However, any subsequent changes to the cosmology</span>
<span class="sd">        configuration option using `ConfigurationItem.set</span>
<span class="sd">        &lt;astropy.config.configuration.ConfigurationItem.set&gt;` at run-time</span>
<span class="sd">        will not update the current cosmology.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cosmo : str or `Cosmology` instance</span>
<span class="sd">      The cosmology to use.</span>



<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    get_current : returns the currently-set cosmology</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_current</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cosmo</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
        <span class="n">_current</span> <span class="o">=</span> <span class="n">get_cosmology_from_string</span><span class="p">(</span><span class="n">cosmo</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cosmo</span><span class="p">,</span> <span class="n">Cosmology</span><span class="p">):</span>
        <span class="n">_current</span> <span class="o">=</span> <span class="n">cosmo</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s">&quot;Argument must be a string or cosmology instance. Valid strings:&quot;</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">parameters</span><span class="o">.</span><span class="n">available</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">


<h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>

<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2013, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3+. &nbsp;
    Last built 03 Apr 2013. <br/>
  </p>
</footer>
 <!-- End original user content -->


<br>
<br>
<br>


<style type="text/css">
  .rtd-badge {
    position: fixed;
    display: block;
    bottom: 5px;
    height: 40px;
    text-indent: -9999em;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
  }
  #version_menu {
    position: fixed;
    display: none;
    bottom: 11px;
    right: 166px;
    list-style-type: none;
    margin: 0;
  }
  .footer_popout:hover #version_menu {
    display: block;
  }
  #version_menu li {
    display: block;
    float: right;
  }
  #version_menu li a {
    display: block;
    padding: 6px 10px 4px 10px;
    margin: 7px 7px 0 0;
    font-weight: bold;
    font-size: 14px;
    height: 20px;
    line-height: 17px;
    text-decoration: none;
    color: #fff;
    background: #8ca1af url(../images/gradient-light.png) bottom left repeat-x;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 1px #465158;
    -moz-box-shadow: 0 1px 1px #465158;
    -webkit-box-shadow: 0 1px 1px #465158;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
  }
  #version_menu li a:hover {
    text-decoration: none;
    background-color: #697983;
    box-shadow: 0 1px 0px #465158;
    -moz-box-shadow: 0 1px 0px #465158;
    -webkit-box-shadow: 0 1px 0px #465158;
  }
  .rtd-badge.rtd {
    background: #3b4449 url(//media.readthedocs.org//images/badge-rtd.png) scroll 0px -46px no-repeat;
    border: 1px solid #282E32;
    width: 41px;
    right: 5px;
  }
  .footer_popout:hover .rtd-badge.rtd {
    background-position: top left;
    width: 160px;
  }
  .rtd-badge.revsys { background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline-sponsored {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys-sm.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 205px;
    right: 173px;
  }

</style>
<div class="rtd_doc_footer">
  <div class="footer_popout">
    <a href="//readthedocs.org/projects/astropy/?fromdocs=astropy" class="rtd-badge rtd"> Brought to you by Read the Docs</a>
    <ul id="version_menu">
      
        <li><a href="/en/latest/">latest</a></li>
      
        <li><a href="/en/add-mpl-to-rtd-pip-req/">add-mpl-to-rtd-pip-req</a></li>
      
        <li><a href="/en/v0.2.1/">v0.2.1</a></li>
      
        <li><a href="/en/v0.2/">v0.2</a></li>
      
        <li><a href="/en/v0.1/">v0.1</a></li>
      
    </ul>
  </div>
</div>
<!-- RTD Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<!-- User Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30968842-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>