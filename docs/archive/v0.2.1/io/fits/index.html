
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>FITS File handling (astropy.io.fits) &mdash; Astropy v0.2.1</title>
<!-- RTD <head> -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/underscore.js"></script>
<script type="text/javascript" src="//media.readthedocs.org/javascript/doctools.js"></script>

<script type="text/javascript">
  // This is included here for Javascript that doesn't have access to the templates.
  var doc_version = "v0.2.1";
  var doc_slug = "astropy";
</script>

<script type="text/javascript" src="//media.readthedocs.org/javascript/rtd.js"></script>
<!-- end RTD <head> -->

    
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v0.2.1" href="../../index.html" />
    <link rel="next" title="FITS Headers" href="usage/headers.html" />
    <link rel="prev" title="wpwaCDM" href="../../_generated/astropy.cosmology.core.wpwaCDM.html" /> 
  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"></a>
  <ul>
    <li><a class="homelink" title="AstroPy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Python Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="usage/headers.html" title="FITS Headers">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../../_generated/astropy.cosmology.core.wpwaCDM.html" title="wpwaCDM">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v0.2.1</a>
	 &raquo;
      </li>
      
      <li>FITS File handling (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">astropy.io.fits</span></tt>)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="fits-file-handling-astropy-io-fits">
<h1>FITS File handling (<tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></tt>)<a class="headerlink" href="#fits-file-handling-astropy-io-fits" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="xref py py-mod docutils literal"><span class="pre">astropy.io.fits</span></tt> package provides access to FITS files. FITS
(Flexible Image Transport System) is a portable file standard widely used in
the astronomy community to store images and tables.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This section provides a quick introduction of using <tt class="xref py py-mod docutils literal"><span class="pre">astropy.io.fits</span></tt>. The
goal is to demonstrate the package&#8217;s basic features without getting into too
much detail. If you are a first time user or have never used Astropy or PyFITS,
this is where you should start.</p>
<div class="section" id="reading-and-updating-existing-fits-files">
<h3>Reading and Updating Existing FITS Files<a class="headerlink" href="#reading-and-updating-existing-fits-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="opening-a-fits-file">
<h4>Opening a FITS file<a class="headerlink" href="#opening-a-fits-file" title="Permalink to this headline">¶</a></h4>
<p>Once the <tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></tt> package is loaded using the standard convention<a class="footnote-reference" href="#f1" id="id1">[1]</a>, we can open an existing FITS file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;input.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><tt class="xref py py-func docutils literal"><span class="pre">open()</span></tt></a> function has several optional arguments which
will be discussed in a later chapter. The default mode, as in the above
example, is &#8220;readonly&#8221;.  The open function returns an object called an
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><tt class="xref py py-class docutils literal"><span class="pre">HDUList</span></tt></a> which is a Python list-like collection of HDU objects. An HDU
(Header Data Unit) is the highest level component of the FITS file structure.
So, after the above open call, <tt class="docutils literal"><span class="pre">hdulist[0]</span></tt> is the primary HDU,
<tt class="docutils literal"><span class="pre">hdulist[1]</span></tt>, if any, is the first extension HDU, etc.  It should be noted
that Astropy is using zero-based indexing when referring to HDUs and header
cards, though the FITS standard (which was designed with FORTRAN in mind) uses
one-based indexing.</p>
<p>The <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><tt class="xref py py-class docutils literal"><span class="pre">HDUList</span></tt></a> has a useful method <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.info" title="astropy.io.fits.HDUList.info"><tt class="xref py py-meth docutils literal"><span class="pre">HDUList.info()</span></tt></a>, which
summarizes the content of the opened FITS file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">Filename: test1.fits</span>
<span class="go">No. Name  Type       Cards Dimensions Format</span>
<span class="go">0 PRIMARY PrimaryHDU   220 ()         int16</span>
<span class="go">1 SCI     ImageHDU      61 (800, 800) float32</span>
<span class="go">2 SCI     ImageHDU      61 (800, 800) float32</span>
<span class="go">3 SCI     ImageHDU      61 (800, 800) float32</span>
<span class="go">4 SCI     ImageHDU      61 (800, 800) float32</span>
</pre></div>
</div>
<p>After you are done with the opened file, close it with the
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><tt class="xref py py-meth docutils literal"><span class="pre">HDUList.close()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The headers will still be accessible after the HDUList is closed. The data may
or may not be accessible depending on whether the data are touched and if they
are memory-mapped, see later chapters for detail.</p>
<div class="section" id="working-with-large-files">
<h5>Working with large files<a class="headerlink" href="#working-with-large-files" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><tt class="xref py py-func docutils literal"><span class="pre">open()</span></tt></a> function supports a <tt class="docutils literal"><span class="pre">memmap=True</span></tt> argument that allows the
array data of each HDU to be accessed with mmap, rather than being read into
memory all at once.  This is particularly useful for working with very large
arrays that cannot fit entirely into physical memory.</p>
<p>This has minimal impact on smaller files as well, though some operations, such
as reading the array data sequentially, may incur some additional overhead.  On
32-bit systems arrays larger than 2-3 GB cannot be mmap&#8217;d (which is fine,
because by that point you&#8217;re likely to run out of physical memory anyways), but
64-bit systems are much less limited in this respect.</p>
</div>
</div>
<div class="section" id="working-with-a-fits-header">
<h4>Working With a FITS Header<a class="headerlink" href="#working-with-a-fits-header" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, each element of an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><tt class="xref py py-class docutils literal"><span class="pre">HDUList</span></tt></a> is an HDU object with
attributes of header and data, which can be used to access the header keywords
and the data.</p>
<p>For those unfamiliar with FITS headers, they consist of a list of &#8220;cards&#8221;,
where a card contains a keyword, a value, and a comment.  The keyword and
comment must both be strings, whereas the value can be a string or an integer,
float, or complex number.  Keywords are usually unique within a header, except
in a few special cases.</p>
<p>The header attribute is a Header instance, another Astropy object. To get the
value associated with a header keyword, simply do (a la Python dicts):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;NGC121&#39;</span>
</pre></div>
</div>
<p>to get the value of the keyword targname, which is a string &#8216;NGC121&#8217;.</p>
<p>Although keyword names are always in upper case inside the FITS file,
specifying a keyword name with Astropy is case-insensitive, for the user&#8217;s
convenience. If the specified keyword name does not exist, it will raise a
<tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt> exception.</p>
<p>We can also get the keyword value by indexing (a la Python lists):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
<span class="go">96</span>
</pre></div>
</div>
<p>This example returns the 28th (like Python lists, it is 0-indexed) keyword&#8217;s
value&#8211;an integer&#8211;96.</p>
<p>Similarly, it is easy to update a keyword&#8217;s value in Astropy, either through
keyword name or index:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;NGC121-a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
<p>It is also possible to update both the value and comment associated with a
keyword by assigning them as a tuple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;NGC121-a&#39;</span><span class="p">,</span> <span class="s">&#39;the observation target&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;NGC121-a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="o">.</span><span class="n">comments</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;the observation target&#39;</span>
</pre></div>
</div>
<p>Like a dict, one may also use the above syntax to add a new keyword/value pair
(and optionally a comment as well).  In this case the new card is appended to
the end of the header (unless it&#8217;s a commentary keyword such as COMMENT or
HISTORY, in which case it is appended after the last card with that keyword).</p>
<p>Another way to either update an existing card or append a new one is to use the
<a class="reference internal" href="api/headers.html#astropy.io.fits.Header.set" title="astropy.io.fits.Header.set"><tt class="xref py py-meth docutils literal"><span class="pre">Header.set()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;observer&#39;</span><span class="p">,</span> <span class="s">&#39;Edwin Hubble&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comment or history records are added like normal cards, though in their case a
new card is always created, rather than updating an existing HISTORY or COMMENT
card:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I updated this file 2/26/09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Edwin Hubble really knew his stuff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I like using HST observations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
<span class="go">Edwin Hubble really knew his stuff</span>
<span class="go">I like using HST observations</span>
</pre></div>
</div>
<p>Note: Be careful not to confuse COMMENT cards with the comment value for normal
cards.</p>
<p>To updating existing COMMENT or HISTORY cards, reference them by index:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I updated this file on 2/26/09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">]</span>
<span class="go">I updated this file on 2/26/09</span>
</pre></div>
</div>
<p>To see the entire header as it appears in the FITS file (with the END card and
padding stripped), simply enter the header object by itself, or print
repr(header):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">header</span>
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
<span class="go">NAXIS   =                    0 / number of data axes</span>
<span class="go">...all cards are shown...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<span class="go">...identical...</span>
</pre></div>
</div>
<p>It&#8217;s also possible to view a slice of the header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">header</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
</pre></div>
</div>
<p>Only the first two cards are shown above.</p>
<p>To get a list of all keywords, use the <a class="reference internal" href="api/headers.html#astropy.io.fits.Header.keys" title="astropy.io.fits.Header.keys"><tt class="xref py py-meth docutils literal"><span class="pre">Header.keys()</span></tt></a> method just as you
would with a dict:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;SIMPLE&#39;, &#39;BITPIX&#39;, &#39;NAXIS&#39;, ...]</span>
</pre></div>
</div>
</div>
<div class="section" id="working-with-image-data">
<h4>Working With Image Data<a class="headerlink" href="#working-with-image-data" title="Permalink to this headline">¶</a></h4>
<p>If an HDU&#8217;s data is an image, the data attribute of the HDU object will return
a numpy ndarray object. Refer to the numpy documentation for details on
manipulating these numerical arrays.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>Here, scidata points to the data object in the second HDU (the first HDU,
<tt class="docutils literal"><span class="pre">hdulist[0]</span></tt>, being the primary HDU) in <tt class="docutils literal"><span class="pre">hdulist</span></tt>, which corresponds  to
the &#8216;SCI&#8217; extension. Alternatively, you can access the extension by its
extension name (specified in the EXTNAME keyword):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="s">&#39;SCI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>If there is more than one extension with the same EXTNAME, EXTVER&#8217;s value needs
to be specified as the second argument, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="s">&#39;sci&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>The returned numpy object has many attributes and methods for a user to get
information about the array, e. g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(800, 800)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;float32&#39;</span>
</pre></div>
</div>
<p>Since image data is a numpy object, we can slice it, view it, and perform
mathematical operations on it. To see the pixel value at x=5, y=2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">scidata</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that, like C (and unlike FORTRAN), Python is 0-indexed and the indices
have the slowest axis first and fast axis last, i.e. for a 2-D image, the fast
axis (X-axis) which corresponds to the FITS NAXIS1 keyword, is the second
index. Similarly, the 1-indexed sub-section of x=11 to 20 (inclusive) and y=31
to 40 (inclusive) would be given in Python as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<p>To update the value of a pixel or a sub-section:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">scidata</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">999</span>
</pre></div>
</div>
<p>This example changes the values of both the pixel [1, 4] and the sub-section
[30:40, 10:20] to the new value of 999.  See the <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">Numpy documentation</a> for
more details on Python-style array indexing and slicing.</p>
<p>The next example of array manipulation is to convert the image data from counts
to flux:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">photflam</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s">&#39;photflam&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exptime</span> <span class="o">=</span> <span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;exptime&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">*=</span> <span class="n">photflam</span> <span class="o">/</span> <span class="n">exptime</span>
</pre></div>
</div>
<p>This example performs the math on the array in-place, thereby keeping the
memory usage to a minimum.</p>
<p>If at this point you want to preserve all the changes you made and write it to
a new file, you can use the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><tt class="xref py py-meth docutils literal"><span class="pre">HDUList.writeto()</span></tt></a> method (see below).</p>
</div>
<div class="section" id="working-with-table-data">
<h4>Working With Table Data<a class="headerlink" href="#working-with-table-data" title="Permalink to this headline">¶</a></h4>
<p>If you are familiar with the record array in numpy, you will find the table
data is basically a record array with some extra properties. But familiarity
with record arrays is not a prerequisite for this Guide.</p>
<p>Like images, the data portion of a FITS table extension is in the <tt class="docutils literal"><span class="pre">.data</span></tt>
attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;table.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="c"># assuming the first extension is a table</span>
</pre></div>
</div>
<p>To see the first row of the table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tbdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(1, &#39;abc&#39;, 3.7000002861022949, 0)</span>
</pre></div>
</div>
<p>Each row in the table is a <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><tt class="xref py py-class docutils literal"><span class="pre">FITS_rec</span></tt></a> object which looks like a (Python)
tuple containing elements of heterogeneous data types. In this example: an
integer, a string, a floating point number, and a Boolean value. So the table
data are just an array of such records. More commonly, a user is likely to
access the data in a column-wise way. This is accomplished by using the
<a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec.field" title="astropy.io.fits.FITS_rec.field"><tt class="xref py py-meth docutils literal"><span class="pre">field()</span></tt></a> method. To get the first column (or field) of the
table, use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([1, 2])</span>
</pre></div>
</div>
<p>A numpy object with the data type of the specified field is returned.</p>
<p>Like header keywords, a field can be referred either by index, as above, or by
name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span>
<span class="go">array([1, 2])</span>
</pre></div>
</div>
<p>But how do we know what field names we&#8217;ve got? First, let&#8217;s introduce another
attribute of the table HDU: the <tt class="xref py py-attr docutils literal"><span class="pre">columns</span></tt> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<p>This attribute is a <a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><tt class="xref py py-class docutils literal"><span class="pre">ColDefs</span></tt></a> (column definitions) object. If we use the
<a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs.info" title="astropy.io.fits.ColDefs.info"><tt class="xref py py-meth docutils literal"><span class="pre">ColDefs.info()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> name:</span>
<span class="go">      [&#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;]</span>
<span class="go"> format:</span>
<span class="go">      [&#39;1J&#39;, &#39;3A&#39;, &#39;1E&#39;, &#39;1L&#39;]</span>
<span class="go"> unit:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go"> null:</span>
<span class="go">      [-2147483647, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go"> bscale:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, 3, &#39;&#39;]</span>
<span class="go"> bzero:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, 0.40000000000000002, &#39;&#39;]</span>
<span class="go"> disp:</span>
<span class="go">      [&#39;I11&#39;, &#39;A3&#39;, &#39;G15.7&#39;, &#39;L6&#39;]</span>
<span class="go"> start:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go"> dim:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
</pre></div>
</div>
<p>it will show all its attributes, such as names, formats, bscales, bzeros, etc.
We can also get these properties individually, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span><span class="o">.</span><span class="n">names</span>
<span class="go">[&#39;ID&#39;, &#39;name&#39;, &#39;mag&#39;, &#39;flag&#39;]</span>
</pre></div>
</div>
<p>returns a (Python) list of field names.</p>
<p>Since each field is a numpy object, we&#8217;ll have the entire arsenal of numpy
tools to use. We can reassign (update) the values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s">&#39;flag&#39;</span><span class="p">)[:]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="save-file-changes">
<h4>Save File Changes<a class="headerlink" href="#save-file-changes" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, after a user opened a file, made a few changes to either
header or data, the user can use <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><tt class="xref py py-meth docutils literal"><span class="pre">HDUList.writeto()</span></tt></a> to save the changes.
This takes the version of headers and data in memory and writes them to a new
FITS file on disk. Subsequent operations can be performed to the data in memory
and written out to yet another different file, all without recopying the
original data to (more) memory.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;newimage.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will write the current content of <tt class="docutils literal"><span class="pre">hdulist</span></tt> to a new disk file newfile.fits.
If a file was opened with the update mode, the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.flush" title="astropy.io.fits.HDUList.flush"><tt class="xref py py-meth docutils literal"><span class="pre">HDUList.flush()</span></tt></a> method can
also be used to write all the changes made since <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><tt class="xref py py-func docutils literal"><span class="pre">open()</span></tt></a>, back to the
original file. The <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><tt class="xref py py-meth docutils literal"><span class="pre">close()</span></tt></a> method will do the same for a FITS
file opened with update mode.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;original.fits&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;update&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="c"># making changes in data and/or header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span> <span class="c"># changes are written back to original.fits</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-a-new-fits-file">
<h3>Creating a New FITS File<a class="headerlink" href="#creating-a-new-fits-file" title="Permalink to this headline">¶</a></h3>
<div class="section" id="creating-a-new-image-file">
<h4>Creating a New Image File<a class="headerlink" href="#creating-a-new-image-file" title="Permalink to this headline">¶</a></h4>
<p>So far we have demonstrated how to read and update an existing FITS file. But
how about creating a new FITS file from scratch? Such tasks are very easy in
Astropy for an image HDU. We&#8217;ll first demonstrate how to create a FITS file
consisting only the primary HDU with image data.</p>
<p>First, we create a numpy object for the data part:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span> <span class="c"># a simple sequence of floats from 0.0 to 99.9</span>
</pre></div>
</div>
<p>Next, we create a <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><tt class="xref py py-class docutils literal"><span class="pre">PrimaryHDU</span></tt></a> object to encapsulate the data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>We then create a HDUList to contain the newly created primary HDU, and write to
a new file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">hdu</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;new.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s it! In fact, Astropy even provides a shortcut for the last two lines to
accomplish the same behavior:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;new.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-new-table-file">
<h4>Creating a New Table File<a class="headerlink" href="#creating-a-new-table-file" title="Permalink to this headline">¶</a></h4>
<p>To create a table HDU is a little more involved than image HDU, because a
table&#8217;s structure needs more information. First of all, tables can only be an
extension HDU, not a primary. There are two kinds of FITS table extensions:
ASCII and binary. We&#8217;ll use binary table examples here.</p>
<p>To create a table from scratch, we need to define columns first, by
constructing the <a class="reference internal" href="api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><tt class="xref py py-class docutils literal"><span class="pre">Column</span></tt></a> objects and their data. Suppose we have two
columns, the first containing strings, and the second containing floating point
numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;NGC1001&#39;</span><span class="p">,</span> <span class="s">&#39;NGC1002&#39;</span><span class="p">,</span> <span class="s">&#39;NGC1003&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">11.1</span><span class="p">,</span> <span class="mf">12.3</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;target&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;20A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;V_mag&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a2</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, create a <a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><tt class="xref py py-class docutils literal"><span class="pre">ColDefs</span></tt></a> (column-definitions) object for all columns:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now, create a new binary table HDU object by using the <a class="reference internal" href="api/tables.html#astropy.io.fits.new_table" title="astropy.io.fits.new_table"><tt class="xref py py-func docutils literal"><span class="pre">new_table()</span></tt></a>
function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbhdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">new_table</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
<p>This function returns (in this case) a <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><tt class="xref py py-class docutils literal"><span class="pre">BinTableHDU</span></tt></a>.</p>
<p>Of course, you can do this more concisely:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tbhdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">new_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;target&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;20A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a1</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;V_mag&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a2</span><span class="p">)]))</span>
</pre></div>
</div>
<p>As before, we create a <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><tt class="xref py py-class docutils literal"><span class="pre">PrimaryHDU</span></tt></a> object to encapsulate the data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>We then create a HDUList containing both the primary HDU and the newly created
table extension, and write to a new file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">thdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">hdu</span><span class="p">,</span> <span class="n">tbhdu</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;table.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If this will be the only extension of the new FITS file and you only have a
minimal primary HDU with no data, Astropy again provides a shortcut:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbhdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;table.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can append it to the hdulist we have already created from
the image file section:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tbhdu</span><span class="p">)</span>
</pre></div>
</div>
<p>So far, we have covered the most basic features of <tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></tt>. In the
following chapters we&#8217;ll show more advanced examples and explain options in
each class and method.</p>
</div>
</div>
<div class="section" id="convenience-functions">
<h3>Convenience Functions<a class="headerlink" href="#convenience-functions" title="Permalink to this headline">¶</a></h3>
<p><tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></tt> also provides several high level (&#8220;convenience&#8221;) functions.
Such a convenience function is a &#8220;canned&#8221; operation to achieve one simple task.
By using these &#8220;convenience&#8221; functions, a user does not have to worry about
opening or closing a file, all the housekeeping is done implicitly.</p>
<p>The first of these functions is <a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><tt class="xref py py-func docutils literal"><span class="pre">getheader()</span></tt></a>, to get the header of an HDU.
Here are several examples of getting the header. Only the file name is required
for this function. The rest of the arguments are optional and flexible to
specify which HDU the user wants to get:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getheader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">)</span> <span class="c"># get default HDU (=0), i.e. primary HDU&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c"># get primary HDU&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># the second extension</span>
<span class="go"># the HDU with EXTNAME=&#39;sci&#39; (if there is only 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">)</span>
<span class="go"># the HDU with EXTNAME=&#39;sci&#39; and EXTVER=2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c"># use a tuple to do the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c"># the second extension</span>
<span class="go"># the &#39;sci&#39; extension, if there is only 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">extname</span><span class="o">=</span><span class="s">&#39;sci&#39;</span><span class="p">)</span>
<span class="go"># the HDU with EXTNAME=&#39;sci&#39; and EXTVER=2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">extname</span><span class="o">=</span><span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="n">extver</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go"># ambiguous specifications will raise an exception, DON&#39;T DO IT!!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;sci&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">extname</span><span class="o">=</span><span class="s">&#39;err&#39;</span><span class="p">,</span> <span class="n">extver</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>After you get the header, you can access the information in it, such as getting
and modifying a keyword value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getheader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># get first extension&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s">&#39;filter&#39;</span><span class="p">]</span> <span class="c"># get the value of the keyword &quot;filter&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="c"># get the 11th keyword&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s">&#39;filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;FW555&#39;</span> <span class="c"># change the keyword value</span>
</pre></div>
</div>
<p>For the header keywords, the header is like a dictionary, as well as a list.
The user can access the keywords either by name or by numeric index, as
explained earlier in this chapter.</p>
<p>If a user only needs to read one keyword, the  <a class="reference internal" href="api/files.html#astropy.io.fits.getval" title="astropy.io.fits.getval"><tt class="xref py py-func docutils literal"><span class="pre">getval()</span></tt></a> function can
further simplify to just one call, instead of two as shown in the above
examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flt</span> <span class="o">=</span> <span class="n">getval</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;filter&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># get 1st extension&#39;s keyword</span>
<span class="go">                                         # FILTER&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">getval</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># get the 2nd sci extension&#39;s</span>
<span class="go">                                          # 11th keyword&#39;s value</span>
</pre></div>
</div>
<p>The function <a class="reference internal" href="api/files.html#astropy.io.fits.getdata" title="astropy.io.fits.getdata"><tt class="xref py py-func docutils literal"><span class="pre">getdata()</span></tt></a> gets the data of an HDU. Similar to
<a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><tt class="xref py py-func docutils literal"><span class="pre">getheader()</span></tt></a>, it only requires the input FITS file name while the
extension is specified through the optional arguments. It does have one extra
optional argument header. If header is set to True, this function will return
both data and header, otherwise only data is returned.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c"># get 3rd sci extension&#39;s data</span>
<span class="go"># get 1st extension&#39;s data and header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The functions introduced above are for reading. The next few functions
demonstrate convenience functions for writing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;out.fits&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.writeto" title="astropy.io.fits.writeto"><tt class="xref py py-func docutils literal"><span class="pre">writeto()</span></tt></a> function uses the provided data and an optional header to
write to an output FITS file.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;out.fits&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.append" title="astropy.io.fits.append"><tt class="xref py py-func docutils literal"><span class="pre">append()</span></tt></a> function will use the provided data and the optional header
to append to an existing FITS file. If the specified output file does not
exist, it will create one.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">update</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">)</span> <span class="c"># update the &#39;sci&#39; extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c"># update the 3rd extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c"># update the 3rd extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c"># update the 2nd SCI extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">)</span> <span class="c"># update the 3rd extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c"># update the 5th extension</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.update" title="astropy.io.fits.update"><tt class="xref py py-func docutils literal"><span class="pre">update()</span></tt></a> function will update the specified extension with the input
data/header. The 3rd argument can be the header associated with the data. If
the 3rd argument is not a header, it (and other positional arguments) are
assumed to be the extension specification(s). Header and extension specs can
also be keyword arguments.</p>
<p>Finally, the <a class="reference internal" href="api/files.html#astropy.io.fits.info" title="astropy.io.fits.info"><tt class="xref py py-func docutils literal"><span class="pre">info()</span></tt></a> function will print out information of the specified
FITS file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;test0.fits&#39;</span><span class="p">)</span>
<span class="go">Filename: test0.fits</span>
<span class="go">No. Name    Type       Cards Dimensions Format</span>
<span class="go">0   PRIMARY PrimaryHDU   138 ()         Int16</span>
<span class="go">1   SCI     ImageHDU      61 (400, 400) Int16</span>
<span class="go">2   SCI     ImageHDU      61 (400, 400) Int16</span>
<span class="go">3   SCI     ImageHDU      61 (400, 400) Int16</span>
<span class="go">4   SCI     ImageHDU      61 (400, 400) Int16</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-io-fits">
<h2>Using <tt class="xref py py-obj docutils literal"><span class="pre">io.fits</span></tt><a class="headerlink" href="#using-io-fits" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/headers.html">FITS Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#header-of-an-hdu">Header of an HDU</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#the-header-attribute">The Header Attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#card-images">Card Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#continue-cards">CONTINUE Cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#hierarch-cards">HIERARCH Cards</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/image.html">Image Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#image-data-as-an-array">Image Data as an Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#scaled-data">Scaled Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#data-sections">Data Sections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/table.html">Table Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#table-data-as-a-record-array">Table Data as a Record Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#table-operations">Table Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#scaled-data-in-tables">Scaled Data in Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#creating-a-fits-table">Creating a FITS Table</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/verification.html">Verification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#fits-standard">FITS Standard</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verification-options">Verification Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verifications-at-different-data-object-levels">Verifications at Different Data Object Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verification-using-the-fits-checksum-keyword-convention">Verification using the FITS Checksum Keyword Convention</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/unfamiliar.html">Less Familiar Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#ascii-tables">ASCII Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#variable-length-array-tables">Variable Length Array Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#random-access-groups">Random Access Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#compressed-image-data">Compressed Image Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/scripts.html">Executable Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitscheck">fitscheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#fitsdiff">fitsdiff</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/misc.html">Miscellaneous Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/misc.html#warning-messages">Warning Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/misc.html#differs">Differs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/examples.html#converting-a-3-color-image-jpg-to-separate-fits-images">Converting a 3-color image (JPG) to separate FITS images</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="other-information">
<h2>Other Information<a class="headerlink" href="#other-information" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="appendix/faq.html">PyFITS FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/history.html">astropy.io.fits History</a></li>
</ul>
</div>
</div>
<div class="section" id="reference-api">
<h2>Reference/API<a class="headerlink" href="#reference-api" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/files.html">File Handling and Convenience Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#open"><tt class="docutils literal"><span class="pre">open()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#writeto"><tt class="docutils literal"><span class="pre">writeto()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#info"><tt class="docutils literal"><span class="pre">info()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#append"><tt class="docutils literal"><span class="pre">append()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#update"><tt class="docutils literal"><span class="pre">update()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getdata"><tt class="docutils literal"><span class="pre">getdata()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getheader"><tt class="docutils literal"><span class="pre">getheader()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getval"><tt class="docutils literal"><span class="pre">getval()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#setval"><tt class="docutils literal"><span class="pre">setval()</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#delval"><tt class="docutils literal"><span class="pre">delval()</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/hdulists.html">HDU Lists</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hdulists.html#hdulist"><tt class="docutils literal"><span class="pre">HDUList</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/hdus.html">Header Data Units</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#primaryhdu"><tt class="docutils literal"><span class="pre">PrimaryHDU</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#groupshdu"><tt class="docutils literal"><span class="pre">GroupsHDU</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#groupdata"><tt class="docutils literal"><span class="pre">GroupData</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#group"><tt class="docutils literal"><span class="pre">Group</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#streaminghdu"><tt class="docutils literal"><span class="pre">StreamingHDU</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/headers.html">Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/headers.html#header"><tt class="docutils literal"><span class="pre">Header</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/cards.html">Cards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/cards.html#card"><tt class="docutils literal"><span class="pre">Card</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/cards.html#deprecated-interfaces">Deprecated Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/tables.html">Tables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#bintablehdu"><tt class="docutils literal"><span class="pre">BinTableHDU</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#tablehdu"><tt class="docutils literal"><span class="pre">TableHDU</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#column"><tt class="docutils literal"><span class="pre">Column</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#coldefs"><tt class="docutils literal"><span class="pre">ColDefs</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#fits-rec"><tt class="docutils literal"><span class="pre">FITS_rec</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#fits-record"><tt class="docutils literal"><span class="pre">FITS_record</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#table-functions">Table Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#new-table"><tt class="docutils literal"><span class="pre">new_table()</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#tabledump"><tt class="docutils literal"><span class="pre">tabledump()</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#tableload"><tt class="docutils literal"><span class="pre">tableload()</span></tt></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/images.html">Images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/images.html#imagehdu"><tt class="docutils literal"><span class="pre">ImageHDU</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/images.html#compimagehdu"><tt class="docutils literal"><span class="pre">CompImageHDU</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/diff.html">Differs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#fitsdiff"><tt class="docutils literal"><span class="pre">FITSDiff</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#hdudiff"><tt class="docutils literal"><span class="pre">HDUDiff</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#headerdiff"><tt class="docutils literal"><span class="pre">HeaderDiff</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#imagedatadiff"><tt class="docutils literal"><span class="pre">ImageDataDiff</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#rawdatadiff"><tt class="docutils literal"><span class="pre">RawDataDiff</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#tabledatadiff"><tt class="docutils literal"><span class="pre">TableDataDiff</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/verification.html">Verification options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#exception">exception</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#ignore">ignore</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#fix">fix</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#silentfix">silentfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#warn">warn</a></li>
</ul>
</li>
</ul>
</div>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>For legacy code only that already depends on PyFITS, it&#8217;s acceptable to continue using &#8220;from astropy.io import fits as pyfits&#8221;.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">


<h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">FITS File handling (<tt class="docutils literal"><span class="pre">astropy.io.fits</span></tt>)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#reading-and-updating-existing-fits-files">Reading and Updating Existing FITS Files</a><ul>
<li><a class="reference internal" href="#opening-a-fits-file">Opening a FITS file</a><ul>
<li><a class="reference internal" href="#working-with-large-files">Working with large files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-a-fits-header">Working With a FITS Header</a></li>
<li><a class="reference internal" href="#working-with-image-data">Working With Image Data</a></li>
<li><a class="reference internal" href="#working-with-table-data">Working With Table Data</a></li>
<li><a class="reference internal" href="#save-file-changes">Save File Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-new-fits-file">Creating a New FITS File</a><ul>
<li><a class="reference internal" href="#creating-a-new-image-file">Creating a New Image File</a></li>
<li><a class="reference internal" href="#creating-a-new-table-file">Creating a New Table File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#convenience-functions">Convenience Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-io-fits">Using <tt class="docutils literal"><span class="pre">io.fits</span></tt></a><ul>
</ul>
</li>
<li><a class="reference internal" href="#other-information">Other Information</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#reference-api">Reference/API</a><ul>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>

<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/v0.2.1/docs/io/fits/index.rst">Edit This Page on Github</a> &nbsp;
    <a href="../../_sources/io/fits/index.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2013, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3+. &nbsp;
    Last built 03 Apr 2013. <br/>
  </p>
</footer>
 <!-- End original user content -->


<br>
<br>
<br>


<style type="text/css">
  .rtd-badge {
    position: fixed;
    display: block;
    bottom: 5px;
    height: 40px;
    text-indent: -9999em;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
  }
  #version_menu {
    position: fixed;
    display: none;
    bottom: 11px;
    right: 166px;
    list-style-type: none;
    margin: 0;
  }
  .footer_popout:hover #version_menu {
    display: block;
  }
  #version_menu li {
    display: block;
    float: right;
  }
  #version_menu li a {
    display: block;
    padding: 6px 10px 4px 10px;
    margin: 7px 7px 0 0;
    font-weight: bold;
    font-size: 14px;
    height: 20px;
    line-height: 17px;
    text-decoration: none;
    color: #fff;
    background: #8ca1af url(../images/gradient-light.png) bottom left repeat-x;
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    box-shadow: 0 1px 1px #465158;
    -moz-box-shadow: 0 1px 1px #465158;
    -webkit-box-shadow: 0 1px 1px #465158;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
  }
  #version_menu li a:hover {
    text-decoration: none;
    background-color: #697983;
    box-shadow: 0 1px 0px #465158;
    -moz-box-shadow: 0 1px 0px #465158;
    -webkit-box-shadow: 0 1px 0px #465158;
  }
  .rtd-badge.rtd {
    background: #3b4449 url(//media.readthedocs.org//images/badge-rtd.png) scroll 0px -46px no-repeat;
    border: 1px solid #282E32;
    width: 41px;
    right: 5px;
  }
  .footer_popout:hover .rtd-badge.rtd {
    background-position: top left;
    width: 160px;
  }
  .rtd-badge.revsys { background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline-sponsored {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 290px;
    right: 173px;
  }
  .rtd-badge.revsys-inline {
    position: inherit;
    margin-left: auto;
    margin-right: 175px;
    margin-bottom: 5px;
    background: #465158 url(//media.readthedocs.org//images/badge-revsys-sm.png) top left no-repeat;
    border: 1px solid #1C5871;
    width: 205px;
    right: 173px;
  }

</style>
<div class="rtd_doc_footer">
  <div class="footer_popout">
    <a href="//readthedocs.org/projects/astropy/?fromdocs=astropy" class="rtd-badge rtd"> Brought to you by Read the Docs</a>
    <ul id="version_menu">
      
        <li><a href="/en/latest/">latest</a></li>
      
        <li><a href="/en/add-mpl-to-rtd-pip-req/">add-mpl-to-rtd-pip-req</a></li>
      
        <li><a href="/en/v0.2.1/">v0.2.1</a></li>
      
        <li><a href="/en/v0.2/">v0.2</a></li>
      
        <li><a href="/en/v0.1/">v0.1</a></li>
      
    </ul>
  </div>
</div>
<!-- RTD Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<!-- User Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30968842-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>